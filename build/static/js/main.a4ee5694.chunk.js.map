{"version":3,"sources":["globals.js","components/viewerSlice.js","components/Header.js","components/Viewer.js","components/ImportModal.js","components/ExportModal.js","components/OptionChoiceModal.js","components/AnimationPanel.js","components/ColorPanel.js","components/GeometryCategoryPanel.js","components/TextureCategoryPanel.js","components/TogglePanel.js","components/OptionPanel.js","components/NodePanel.js","components/initializeViewer.js","components/ModelPanel.js","components/ControlMenu.js","components/ModelList.js","App.js","app/store.js","serviceWorker.js","index.js","components/utils.js"],"names":["window","onclick","event","exportModal","document","getElementById","target","style","display","initialState","modelList","activeModelGUID","viewMode","sketchfabAPI","disableButtons","defaultModel","name","uid","guid","materials","animations","sceneGraph","controls","textureControls","latestControlId","sceneGraphIsVisible","surfaceOptionMap","surfaceConfigurationMode","geometryCategoryOptions","isInitial","viewerSlice","createSlice","reducers","resetState","state","setSketchfabAPI","action","payload","setModelId","i","length","setModelName","setMaterials","setAnimations","setSceneGraph","buildSceneGraph","children","buildGeometryCategoryOptions","setSceneGraphIsVisible","id","value","createControl","defaultControl","type","entityIndex","entity","instanceID","configuration","initialValue","isExpanded","newControl","animationUID","animationName","startTime","endTime","isDisabledInitially","designations","geometries","hiddenValues","allowsAnimation","unshift","setViewMode","setControls","newControls","JSON","parse","stringify","setTextureControls","j","push","addTextureControls","concat","k","textureId","console","log","toggleDisableButtons","updateControl","key","setSurfaceOptionMap","setSurfaceConfigurationMode","setUnselectedGeometries","setAllNodesVisible","Object","keys","show","hide","setModelList","newModelList","undefined","filter","geometry","setActiveModelGUID","createModel","newGuid","Math","floor","random","setIsInitialModel","actions","getAttributeFromModel","attribute","selectModelList","selectActiveModelGUID","selectMaterials","selectAnimations","selectControls","selectDisableButtons","selectSceneGraph","selectSketchfabAPI","selectSceneGraphIsVisible","selectViewMode","selectGeometryCategoryOptions","toggleImportModalDisplay","dispatch","modal","currentStyle","toggleModalDisplay","toggleOptionChoiceModalDisplay","Header","useSelector","useDispatch","className","onClick","disabled","Viewer","class","src","title","allowfullscreen","mozallowfullscreen","webkitallowfullscreen","ImportModal","importString","replace","createJSExport","ExportModal","OptionChoiceModal","color","visibility","AnimationPanel","props","option","animationOptions","map","animation","alignItems","flexDirection","checked","onChange","e","currentlyDisabled","newXConfiguration","newConfiguration","options","selectedIndex","textContent","htmlFor","renderAdditionalColors","additionalColors","index","array","newArray","newColor","colorRGB","hexRgb","format","num","renderColorsOption","materialsHtml","material","ColorPanel","transferObject","newColors","GeometryCategoryPanel","unselectedGeometries","selectedGeometries","renderDisableTextureControls","geometryIndex","control","showChecked","disabledTextureControls","includes","renderDisableMultiSelect","multiSelects","multiSelect","complimentGeometryIndex","designation","hiddenElementDesignation","marginLeft","textAlign","fontWeight","setSelectedGeometries","selected","borderBottom","list","setList","flex","newGeometries","placeholder","humanReadable","newUnselectedGeometries","unSelectedGeometry","splice","fill","preserveAspectRatio","height","width","viewBox","verticalAlign","d","selectedGeometry","TextureConfigurationPanel","newOptions","updateOptions","addDashes","number","dashes","TogglePanel","sceneGraphHtml","node","depth","panelColors","geometryCategory","textureCategory","toggle","OptionPanel","renderPanel","overflow","renderOptions","NodePanel","values","reduce","accum","curr","initializeViewer","modelId","isSeeking","current_anim","apiSkfb","pollTime","duration","timeSlider","iframe","animationsList","getCurrentTime","err","time","percentage","innerHTML","toFixed","seekTo","requestAnimationFrame","api","config","init","this","Sketchfab","urlid","ui_controls","graph_optimizer","ui_animations","ui_watermark","ui_inspector","ui_stop","ui_infos","success","start","addEventListener","pause","getAnimations","play","setCurrentAnimationByUID","getSceneGraph","result","getMaterialList","surfaceOptions","buildTextureOptions","surfaceControls","bind","error","ModelPanel","activeModel","model","marginBottom","ControlMenu","nodesButtonStyles","backgroundColor","optionsButtonStyles","modelButtonStyles","modelListStyles","minWidth","paddingLeft","paddingRight","borderRadius","border","inActiveStyles","borderColor","cursor","activeStyles","ModelList","activeModelGuid","justifyContent","modelGuid","Number","split","marginRight","m","padding","App","configureStore","reducer","viewerReducer","middleware","getDefaultMiddleware","logger","Boolean","location","hostname","match","ReactDOM","render","StrictMode","store","navigator","serviceWorker","ready","then","registration","unregister","module","exports","materialID","uniqueStrings","nodeNameArray","string","mainDesignation","capitalLetter","detailedTitle","indexOf","isFreeGeometry","sort","a","b","charCodeAt","geometryName","materialOptions","primaryValue","isPrimary","ordering","optionExists","l","currentAttributeOptions"],"mappings":"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","file":"static/js/main.a4ee5694.chunk.js","sourcesContent":["// When the user clicks anywhere outside of the modal, close it\r\nwindow.onclick = function(event) {\r\n    var exportModal = document.getElementById(\"modal\");\r\n    if (event.target === exportModal) {\r\n      exportModal.style.display = \"none\";\r\n    }\r\n  }\r\n\r\n","import { createSlice } from '@reduxjs/toolkit';\r\nimport { buildSceneGraph, buildGeometryCategoryOptions } from './utils'\r\n\r\nconst initialState = {\r\n  modelList: [],\r\n  activeModelGUID: \"\",\r\n  viewMode: \"model\",\r\n  sketchfabAPI: null,\r\n  disableButtons: true,\r\n}\r\n\r\nconst defaultModel = {\r\n  name: \"\",\r\n  uid: \"\",\r\n  guid: \"\",\r\n  materials: [],\r\n  animations: [],\r\n  sceneGraph: [],\r\n  controls: [],\r\n  textureControls: [],\r\n  latestControlId: 0,\r\n  sceneGraphIsVisible: {},\r\n  surfaceOptionMap: {},\r\n  surfaceConfigurationMode: false,\r\n  geometryCategoryOptions: [],\r\n  isInitial: false,\r\n};\r\n\r\nexport const viewerSlice = createSlice({\r\n  name: 'viewer',\r\n  initialState,\r\n  reducers: {\r\n    resetState: state => {\r\n      state = initialState;\r\n    },\r\n    setSketchfabAPI: (state, action) => {\r\n      state.sketchfabAPI = action.payload;\r\n    },\r\n    setModelId: (state, action) => {\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          state.modelList[i].uid = action.payload\r\n        }\r\n      }\r\n    },\r\n    setModelName: (state, action) => {\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          state.modelList[i].name = action.payload\r\n        }\r\n      }\r\n    },\r\n    setMaterials: (state, action) => {\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          state.modelList[i].materials = action.payload\r\n        }\r\n      }\r\n    },\r\n    setAnimations: (state, action) => {\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          state.modelList[i].animations = action.payload\r\n        }\r\n      }\r\n    },\r\n    setSceneGraph: (state, action) => {\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          buildSceneGraph(state.modelList[i], action.payload.children[0].children, 0);\r\n          buildGeometryCategoryOptions(state.modelList[i])\r\n        }\r\n      }\r\n    },\r\n    setSceneGraphIsVisible: (state, action) => {\r\n      const { id, value } = action.payload;\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          state.modelList[i].sceneGraphIsVisible[id] = value;\r\n        }\r\n      }\r\n    },\r\n    createControl: (state, action) => {\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          state.modelList[i].latestControlId = state.modelList[i].latestControlId += 1;\r\n          let id = state.modelList[i].latestControlId;\r\n          let defaultControl = {\r\n            type: action.payload,\r\n            id: id,\r\n            name: action.payload,\r\n            entityIndex: \"none\",\r\n            entity: {instanceID: 0},\r\n            configuration: {},\r\n            initialValue: \"\",\r\n            isExpanded: true,\r\n          }\r\n\r\n          let newControl = {};\r\n\r\n          if(action.payload === \"animation\") { \r\n            newControl = {\r\n              ...defaultControl,\r\n              configuration: {\r\n                animationUID:  state.modelList[i].animations[0][0],\r\n                animationName: state.modelList[i].animations[0][1],\r\n                startTime: 0,\r\n                endTime: 0,\r\n                isDisabledInitially: false,\r\n              },\r\n            }\r\n          } else if(action.payload === \"geometryCategory\") {\r\n            newControl = {\r\n              ...defaultControl,\r\n              configuration: {\r\n                designations: [],\r\n                geometries: [],\r\n                hiddenValues: [],\r\n                allowsAnimation: [],  \r\n              }\r\n            }\r\n          } else {\r\n            newControl = {...defaultControl};\r\n          }\r\n          state.modelList[i].controls.unshift(newControl);\r\n        }\r\n      }\r\n    },\r\n    setViewMode: (state, action) => {\r\n      state.viewMode = action.payload\r\n    },\r\n    setControls: (state, action) => {\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          let newControls = JSON.parse(JSON.stringify(action.payload))\r\n          state.modelList[i].controls = newControls;\r\n        }\r\n      }\r\n    },\r\n    setTextureControls: (state, action) => { \r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          state.modelList[i].textureControls = [];\r\n          for (var j=0; j<action.payload.length; ++j) {\r\n            state.modelList[i].latestControlId = state.modelList[i].latestControlId += 1;\r\n            state.modelList[i].textureControls.push({ ...action.payload[j], id: state.modelList[i].latestControlId})\r\n          }     \r\n        }\r\n      }\r\n    },\r\n    addTextureControls: (state) => {\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          if (state.modelList[i].controls.length === 0) {\r\n            state.modelList[i].controls = state.modelList[i].controls.concat(state.modelList[i].textureControls)\r\n          }\r\n          for (let j=0; j<state.modelList[i].textureControls.length; ++j) {\r\n            for (let k=0; k<state.modelList[i].controls.length; ++k) {\r\n              if (state.modelList[i].controls[k].textureId !== state.modelList[i].textureControls[j].textureId) {\r\n                if ( k === state.modelList[i].controls.length - 1) {\r\n                  state.modelList[i].controls.push(state.modelList[i].textureControls[j])\r\n                }\r\n              } else {\r\n                break\r\n              }\r\n            }\r\n          }\r\n          console.log(\"END addTextureControls\")\r\n        }\r\n      }\r\n    },\r\n    toggleDisableButtons: (state) => {\r\n      state.disableButtons = false;\r\n    },\r\n    updateControl: (state, action) => {\r\n      const { id, key, value } = action.payload;\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          for (let j=0; j<state.modelList[i].controls.length; ++j) {\r\n            if (state.modelList[i].controls[j].id == id) {\r\n              state.modelList[i].controls[j][key] = value;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n    setSurfaceOptionMap: (state, action) => {\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          state.modelList[i].surfaceOptionMap = action.payload;\r\n        }\r\n      }\r\n    },\r\n    setSurfaceConfigurationMode: (state, action) => {\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          state.modelList[i].surfaceConfigurationMode = action.payload;\r\n        }\r\n      }\r\n    },\r\n    setUnselectedGeometries: (state, action) => {\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          state.modelList[i].geometryCategoryOptions = action.payload;\r\n        }\r\n      }\r\n    },\r\n    setAllNodesVisible: (state, action) => {  \r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          for(let j=0; j<Object.keys(state.modelList[i].sceneGraphIsVisible).length; ++j) {\r\n            if(action.payload) {\r\n              state.sketchfabAPI.show(Object.keys(state.modelList[i].sceneGraphIsVisible)[j])\r\n            } else {\r\n              state.sketchfabAPI.hide(Object.keys(state.modelList[i].sceneGraphIsVisible)[j])\r\n            }\r\n            state.modelList[i].sceneGraphIsVisible[Object.keys(state.modelList[i].sceneGraphIsVisible)[j]] = action.payload;\r\n          }\r\n        }\r\n      }\r\n    },\r\n    setModelList: (state, action) => {\r\n      state.modelList = [];\r\n      let newModelList = JSON.parse(JSON.stringify(action.payload))\r\n      for (let i=0; i<newModelList.length; ++i) {\r\n          newModelList[i].latestControlId = 1;\r\n          let newControls = JSON.parse(JSON.stringify(newModelList[i].controls))\r\n          for(let j=0; j<newControls.length; ++j) {\r\n            newModelList[i].latestControlId += 1;\r\n            if (newControls[j].type === \"animation\") {\r\n              for (let k=0; k<newModelList[i].animations.length; ++k) {\r\n                if (newControls[j].configuration.animationName === newModelList[i].animations[k][1]) {\r\n                  newControls[j].configuration.animationUID = newModelList[i].animations[k][0]\r\n                }\r\n                if (newControls[j].configuration.animationName === undefined) {\r\n                  newControls[j].configuration.animationName = newModelList[i].animations[0][1]\r\n                  newControls[j].configuration.animationUID = newModelList[i].animations[0][0]\r\n                }\r\n              }\r\n            }\r\n            if (newControls[j].type === \"textureCategory\") {\r\n              newModelList[i].surfaceConfigurationMode = true\r\n            }\r\n            if (newControls[j].type === \"geometryCategory\") {\r\n              for (let k=0; k<newControls[j].configuration.geometries.length; ++k) {\r\n                if (newControls[j].configuration.geometries[k].hiddenValues === undefined) {\r\n                  newControls[j].configuration.geometries[k].hiddenValues = []\r\n                }            \r\n                newModelList[i].geometryCategoryOptions = newModelList[i].geometryCategoryOptions.filter((geometry => geometry.instanceID !== newControls[j].configuration.geometries[k].instanceID))\r\n              }\r\n            }\r\n          }\r\n          newModelList[i].controls = newControls;\r\n      }\r\n      state.modelList = newModelList;\r\n    },\r\n    setActiveModelGUID: (state, action) => {\r\n      state.activeModelGUID = action.payload;\r\n    },\r\n    createModel: (state) => {\r\n      let newGuid = Math.floor(Math.random() * Math.floor(99999999999999999999999999999999999999999))\r\n      state.modelList.push({\r\n        ...defaultModel,\r\n        guid: newGuid,\r\n      })\r\n      state.activeModelGUID = newGuid\r\n    },\r\n    setIsInitialModel: (state, action) => {\r\n      for (let i=0; i<state.modelList.length; ++i) {\r\n        if (state.modelList[i].guid === state.activeModelGUID) {\r\n          state.modelList[i].isInitial = action.payload;\r\n        }\r\n      }\r\n    },\r\n  },\r\n});\r\n\r\nexport const { \r\n  resetState,\r\n  setModelId, \r\n  setModelName,\r\n  createControl, \r\n  toggleDisableButtons,\r\n  updateControl,\r\n  setControls,\r\n  setTextureControls,\r\n  addTextureControls,\r\n  setSceneGraph,\r\n  setSceneGraphIsVisible,\r\n  setViewMode,\r\n  setUnselectedGeometries,\r\n  setSurfaceOptionMap,\r\n  setSurfaceConfigurationMode,\r\n  setAllNodesVisible,\r\n  setAnimations,\r\n  setMaterials,\r\n  setSketchfabAPI,\r\n  setModelList,\r\n  setActiveModelGUID,\r\n  createModel,\r\n  setIsInitialModel,\r\n} = viewerSlice.actions;\r\n\r\nexport const getAttributeFromModel = (state, attribute) => {\r\n  \r\n  for (let i=0; i<state.modelList.length; ++i) {\r\n    if (state.modelList[i].guid === state.activeModelGUID) {\r\n      return state.modelList[i][attribute]\r\n    }\r\n  }\r\n}\r\n\r\nexport const selectModelList = state => state.modelList;\r\n\r\nexport const selectActiveModelGUID = state => state.activeModelGUID;\r\n\r\nexport const selectModelId = state => getAttributeFromModel(state, \"uid\");\r\n\r\nexport const selectMaterials = state => getAttributeFromModel(state, \"materials\")\r\n\r\nexport const selectAnimations = state => getAttributeFromModel(state, \"animations\");\r\n\r\nexport const selectControls = state => getAttributeFromModel(state, \"controls\");\r\n\r\nexport const selectTextureControls = state => getAttributeFromModel(state, \"textureControls\");\r\n\r\nexport const selectDisableButtons = state => state.disableButtons;\r\n\r\nexport const selectSceneGraph = state => getAttributeFromModel(state, \"sceneGraph\");\r\n\r\nexport const selectSketchfabAPI = state => state.sketchfabAPI;\r\n\r\nexport const selectSceneGraphIsVisible = state => getAttributeFromModel(state, \"sceneGraphIsVisible\");\r\n\r\nexport const selectViewMode = state => state.viewMode;\r\n\r\nexport const selectSurfaceOptionMap = state => getAttributeFromModel(state, \"surfaceOptionMap\");\r\n\r\nexport const selectSurfaceConfigurationMode = state => getAttributeFromModel(state, \"surfaceConfigurationMode\");\r\n\r\nexport const selectGeometryCategoryOptions = state => getAttributeFromModel(state, \"geometryCategoryOptions\");\r\n\r\nexport const toggleImportModalDisplay = ()  => dispatch => {\r\n  const modal = document.getElementById(\"import-modal\")\r\n\r\n  const currentStyle = modal.style.display;\r\n  if (currentStyle === 'block') {\r\n    modal.style.display = 'none';\r\n  } else {\r\n    modal.style.display = 'block';\r\n  }   \r\n}\r\n\r\nexport const toggleModalDisplay = () => dispatch => {\r\n  const modal = document.getElementById('modal');\r\n\r\n  const currentStyle = modal.style.display;\r\n  if (currentStyle === 'block') {\r\n    modal.style.display = 'none';\r\n  } else {\r\n    modal.style.display = 'block';\r\n  }  \r\n}\r\n\r\nexport const toggleOptionChoiceModalDisplay = () => dispatch => {\r\n  const modal = document.getElementById('control-choice-modal');\r\n\r\n  const currentStyle = modal.style.display;\r\n  if (currentStyle === 'block') {\r\n    modal.style.display = 'none';\r\n  } else {\r\n    modal.style.display = 'block';\r\n  }  \r\n}\r\n\r\nexport default viewerSlice.reducer;\r\n\r\n\r\n//        /*v*\\            \r\n//     /\\/|***|\\/\\         \r\n//    /   \\***/   \\        \r\n//         /*\\             \r\n//          *              \r\n//          *              \r\n//   ----------------          \r\n//          *              \r\n//          *              \r\n//         \\*/\r\n//    \\   /***\\   /  \r\n//     \\/\\|***|/\\/\r\n//        \\*^*/\r\n//\r\n//","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { \r\n  toggleImportModalDisplay,\r\n  toggleModalDisplay,\r\n  selectDisableButtons,\r\n} from './viewerSlice';\r\n\r\nconst Header = () => {\r\n  const disableButtons = useSelector(selectDisableButtons);\r\n  \r\n  const dispatch = useDispatch();\r\n  return (\r\n    <div className=\"header\">\r\n      <h1 className=\"header__title\">Configurator Studio - v1.1.1</h1>\r\n\r\n      <div className=\"header__buttons\">\r\n        <button \r\n          id=\"import-javascript\"\r\n          className=\"header__button\"\r\n          onClick={() => dispatch(toggleImportModalDisplay())}>Import Configuration</button>\r\n        <button \r\n          id=\"export-javascript\"\r\n          className=\"header__button\"\r\n          disabled={disableButtons}\r\n          onClick={() => dispatch(toggleModalDisplay())}>Export</button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Header;\r\n","import React from 'react';\r\n\r\nconst Viewer = () => {\r\n\r\n    return (        \r\n        <div class=\"viewer\">\r\n            <iframe \r\n                src=\"\" \r\n                id=\"api-frame\" \r\n                title=\"sketchfab-viewer\"\r\n                allowfullscreen mozallowfullscreen=\"true\" \r\n                webkitallowfullscreen=\"true\"\r\n            ></iframe>\r\n            <div id=\"animationControls\"></div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Viewer;\r\n","import React from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { \r\n\ttoggleImportModalDisplay, \r\n    setModelList,\r\n} from './viewerSlice';\r\n\r\nconst ImportModal = () => {\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    return (\r\n        <div id=\"import-modal\">\r\n            <div className=\"modal__content\">\r\n                <span class=\"close\"\r\n                    onClick={() => dispatch(toggleImportModalDisplay())}>&times;</span>\r\n                <div className=\"modal__header\">\r\n                    <h1>Paste Controls Here:</h1>\r\n                </div>\r\n                <button\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tlet jsInput = document.getElementById(\"js-input\").value;\r\n\t\t\t\t\t\tlet importString = jsInput.replace(\"var modelList = \", \"\")\r\n\t\t\t\t\t\tlet modelList = JSON.parse(importString)\r\n                        dispatch(setModelList(modelList))\r\n                        dispatch(toggleImportModalDisplay())\r\n\t\t\t\t\t}}\r\n\t\t\t\t>Import</button>\r\n\t\t\t\t<input id=\"js-input\" />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ImportModal;\r\n","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { \r\n\ttoggleModalDisplay, \r\n\tselectModelList\r\n} from './viewerSlice';\r\n\r\nconst ExportModal = () => {\r\n\tconst modelList = useSelector(selectModelList)\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    return (\r\n        <div id=\"modal\">\r\n            <div className=\"modal__content\">\r\n                <span class=\"close\"\r\n                    onClick={() => dispatch(toggleModalDisplay())}>&times;</span>\r\n                <div className=\"modal__header\">\r\n                    <h1>Add This To Your Page</h1>\r\n                </div>\r\n                <textarea id=\"js-output\" value={createJSExport(modelList)} />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst createJSExport = (modelList) => {\r\n\r\n\treturn (\r\n`\r\n// Sketchfab Viewer API: Change Texture/material\r\nvar version = '1.9.0';\r\nvar iframe = document.getElementById('api-frame');\r\nvar client = new window.Sketchfab(version, iframe);\r\n\r\n/*\r\n\tCOPY THE LINE BELOW\r\n*/\r\n\r\nvar modelList = ${JSON.stringify(modelList)}\r\n\r\n/*\r\n\tCOPY THE LINE ABOVE\r\n*/\r\n\r\nvar currentModelIndex = 0;\r\n\r\nfor (var i=0; i<modelList.length; ++i) {\r\n\tif (modelList[i].isInitial == true) {\r\n\t\tcurrentModelIndex = i;\r\n\t\tbreak;\r\n\t}\r\n}\r\n\r\nvar isElementCategoryControlled = false;\r\nvar surfaceConfigurationMode = false;\r\n\r\nvar animationObjects = {};\r\nvar toggleableItems = {};\r\n\r\nvar currentAnimationIndex = 0;\r\nvar currentAnimationEndTime = 0;\r\n\r\nvar globalDisabledControls = [];\r\n\r\nvar animationsEnabled = false;\r\n\r\nvar apiSkfb, pollTime;\r\nvar upperControlsContainer = document.querySelector(\"#sketchfab-upper-controls\");\r\nvar controlsContainer = document.getElementById('sketchfab-lower-controls');\r\n\r\nvar appContainer = document.querySelector(\"div.sketchfab__container\")\r\nappContainer.style.display = \"block\"\r\n\r\nvar animationControls = document.getElementById(\"sketchfab-animation-controls\")\r\nvar animationButtonContainer = document.getElementById(\"sketchfab-animation-buttons\")\r\nvar animationContainerTitle = document.getElementById(\"sketchfab-animation-controls__title\");\r\n\r\nvar numberOfLowerControls = 0;\r\n\r\npollTime = function() {\r\n\tapiSkfb.getCurrentTime(function(err, time) {\t\r\n\t\tif (animationsEnabled) {\r\n\t\t\tif (currentAnimationEndTime > 0 && time >= currentAnimationEndTime) {\r\n\t\t\t\tapiSkfb.pause();\r\n\t\t\t}\r\n\t\t\trequestAnimationFrame(pollTime);\r\n\t\t}\r\n\t});\r\n};\r\n\r\nvar viewerAPIs = {};\r\n\r\nvar changeViewerContainer = document.querySelector(\"#change-viewer-container\");\r\nvar viewer = document.querySelector(\".sketchfab__viewer\");\r\nvar loader = document.querySelector(\".sketchfab-loader__container\");\r\nvar loaderTitle = document.querySelector(\"#sketchfab-load-model-name\");\r\nloaderTitle.textContent = modelList[currentModelIndex].name;\r\nloader.style.display = \"flex\";\r\nvar errorMessage = document.querySelector(\"#sketchfab-error__container\")\r\nvar screenshotButton = document.querySelector(\"button#sketchfab-screenshot\");\r\nvar modal = document.querySelector(\"#sketchfab-screenshot-modal\");\r\nvar modalPreviewContent = document.querySelector(\"#sketchfab-screenshot-modal-preview-container\");\r\n\r\nvar screenshotModalClose = document.querySelector(\".sketchfab-screenshot-modal-close\");\r\nvar screenshotAnchor = document.querySelector(\"#sketchfab-screenshot-download__button\");\r\nvar screenshotImg = document.querySelector(\"#sketchfab-screenshot-preview\");\r\n\r\nscreenshotModalClose.addEventListener(\"click\", function() {\r\n\tmodal.style.display = \"none\";\r\n});\r\n\r\nvar success = function(api) {\r\n    apiSkfb = api;\r\n\tapi.start(function() {\r\n\t\tloader.style.height = viewer.scrollHeight;\r\n\t\terrorMessage.style.height = viewer.scrollHeight;\r\n\t\t\r\n\t\tscreenshotButton.addEventListener('click', function () {\r\n\t\t\tapi.getScreenShot(800, 800, 'image/png', function (err, result) {\r\n\t\t\t\t\r\n\t\t\t\tscreenshotImg.src = result;\r\n\t\t\t\t\r\n\t\t\t\tscreenshotAnchor.href = result;\r\n\t\t\t});\r\n\t\t\tmodal.style.display = \"block\";\r\n\t\t});\r\n\t\t\r\n\t\tapi.addEventListener('viewerready', function() {\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tloader.style.display = \"none\";\r\n\t\t\t}, 1000);\r\n\t\t\tchangeViewerContainer.style.display = \"flex\";\r\n\t\t\tapi.pause();\r\n\t\t\t\r\n\t\t\tvar animations = [];\r\n\t\t\tfor (let i = 0; i < modelList[currentModelIndex].controls.length; ++i) {\t\r\n\t\t\t\tglobalDisabledControls.push(false);\r\n\t\t\t\t\r\n\t\t\t\tif (modelList[currentModelIndex].controls[i].type == \"animation\") {\r\n\t\t\t\t\tanimationControls.style.display = \"block\";\r\n\t\t\t\t\tanimationContainerTitle.style.display = \"block\";\r\n\t\t\t\t\tscreenshotButton.style.top = \"535px\";\r\n\t\t\t\t\tvar animationButton = document.createElement(\"button\")\r\n\t\t\t\t\tanimationButton.id = \"animation-\" + modelList[currentModelIndex].controls[i].id + \"-\" + i\r\n\t\t\t\t\tanimationButton.textContent = modelList[currentModelIndex].controls[i].name;\r\n\t\t\t\t\tanimationButton.addEventListener('click', function(e) {\r\n\t\t\t\t\t\tvar animationId = e.target.id.split(\"-\")[1]\r\n\t\t\t\t\t\tcurrentAnimationIndex = e.target.id.split(\"-\")[2]\r\n\t\t\t\t\t\tvar startTime = animationObjects[animationId].startTime;\r\n\t\t\t\t\t\tvar endTime = animationObjects[animationId].endTime;\r\n\t\t\t\t\t\tvar animationUID = animationObjects[animationId].uid;\r\n\t\t\t\t\t\tcurrentAnimationEndTime = endTime;\r\n\r\n\t\t\t\t\t\tapiSkfb.setCurrentAnimationByUID(animationUID)\r\n\t\t\t\t\t\tapiSkfb.seekTo(startTime);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar animationButtons = document.querySelector(\"#sketchfab-animation-buttons\").querySelectorAll(\"button\")\r\n\t\t\t\t\t\tfor (var j=0; j<animationButtons.length; ++j) {\r\n\t\t\t\t\t\t\tanimationButtons[j].disabled = false;\r\n\t\t\t\t\t\t\tanimationButtons[j].style.border = \"none\"\r\n\t\t\t\t\t\t\tanimationButtons[j].style.opacity = 1\r\n\t\t\t\t\t\t\tif (animationButtons[j].textContent === e.target.textContent) {\r\n\t\t\t\t\t\t\t\tanimationButtons[j].disabled = true;\r\n\t\t\t\t\t\t\t\tanimationButtons[j].style.border = \"1px solid black\"\r\n\t\t\t\t\t\t\t\tanimationButtons[j].style.opacity = 0.5\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetTimeout(function() { apiSkfb.play();\t}, 100);\r\n\t\t\t\t\t})\r\n\t\t\t\t\tanimationButtonContainer.appendChild(animationButton)\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar isInitialAnimationPosition = modelList[currentModelIndex].controls[i].configuration.isDisabledInitially\r\n\t\t\t\t\tif (isInitialAnimationPosition) {\r\n\t\t\t\t\t\tanimationButton.disabled = true;\r\n\t\t\t\t\t\tanimationButton.style.border = \"1px solid black\"\r\n\t\t\t\t\t\tanimationButton.style.opacity = 0.5\r\n\t\t\t\t\t\tcurrentAnimationIndex = i\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tanimations.push(modelList[currentModelIndex].controls[i]);\r\n\t\t\t\t\tanimationObjects[modelList[currentModelIndex].controls[i].id] = {name: modelList[currentModelIndex].controls[i].name, startTime: Number(modelList[currentModelIndex].controls[i].configuration.startTime), endTime: Number(modelList[currentModelIndex].controls[i].configuration.endTime), uid: modelList[currentModelIndex].controls[i].configuration.animationUID}; \r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tvar singleControlContainer = document.createElement(\"div\");\r\n\t\t\t\tsingleControlContainer.classList.add(\"sketchfab-single-control-container\");\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tif (modelList[currentModelIndex].controls[i].type == \"color\") {\r\n\t\t\t\t\tvar resetBut = document.createElement(\"button\");\r\n\t\t\t\t\tresetBut.innerHTML = \"Reset\";\r\n\t\t\t\t\tresetBut.onclick = function(e) {\t\r\n\t\t\t\t\t\tvar m = modelList[currentModelIndex].materials[modelList[currentModelIndex].controls[i].entityIndex];\r\n\t\t\t\t\t\tm = JSON.parse(JSON.stringify(modelList[currentModelIndex].controls[i].entity));\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tapi.setMaterial(m);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsingleControlContainer.appendChild(resetBut);\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (let j = 0; j < modelList[currentModelIndex].controls[i].additionalColors.length; ++j) {\r\n\t\t\t\t\t\tvar colorBut = document.createElement(\"button\");\r\n\r\n\t\t\t\t\t\tcolorBut.innerHTML = modelList[currentModelIndex].controls[i].additionalColors[j].name;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcolorBut.id = modelList[currentModelIndex].controls[i].id + \"-\" + modelList[currentModelIndex].controls[i].name\r\n\t\t\t\t\t\tcolorBut.onclick = function(e) {\t\r\n\t\t\t\t\t\t\tvar m = modelList[currentModelIndex].materials[modelList[currentModelIndex].controls[i].entityIndex];\r\n\t\t\t\t\t\t\tm.channels.AlbedoPBR.factor = 1;\r\n\t\t\t\t\t\t\tm.channels.AlbedoPBR.enable = true;\r\n\t\t\t\t\t\t\tm.channels.AlbedoPBR.color = modelList[currentModelIndex].controls[i].additionalColors[j].colorRGB;\r\n\t\t\t\t\t\t\tm.channels.AlbedoPBR.texture = null;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tm.channels.DiffuseColor.factor = 1;\r\n\t\t\t\t\t\t\tm.channels.DiffuseColor.enable = true;\r\n\t\t\t\t\t\t\tm.channels.DiffuseColor.color = modelList[currentModelIndex].controls[i].additionalColors[j].colorRGB;\r\n\t\t\t\t\t\t\tm.channels.DiffuseColor.texture = null;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tm.channels.DiffusePBR.color = modelList[currentModelIndex].controls[i].additionalColors[j].colorRGB;\r\n\t\t\t\t\t\t\tm.channels.DiffusePBR.enable = false;\r\n\t\t\t\t\t\t\tm.channels.DiffusePBR.factor = 1;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tapi.setMaterial(m);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsingleControlContainer.appendChild(colorBut);\r\n\t\t\t\t\t}\t\r\n\t\t\t\t} else if (modelList[currentModelIndex].controls[i].type === \"geometryCategory\") {\r\n\t\t\t\t\tnumberOfLowerControls += 1;\r\n\t\t\t\t\tisElementCategoryControlled = true;\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar label = document.createElement(\"h4\");\r\n\t\t\t\t\tlabel.classList.add(\"sketchfab-dropdown-label\");\r\n\t\t\t\t\tlabel.textContent = modelList[currentModelIndex].controls[i].name;\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar wrapper = initializeSelect(i);\r\n\t\t\t\t\twrapper.classList.add(\"sketchfab-geometry-category\")\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar customOptions = wrapper.querySelector(\".sketchfab-options\")\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (var j=0; j<modelList[currentModelIndex].controls[i].configuration.geometries.length; ++j) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet customOption = document.createElement(\"span\")\r\n\t\t\t\t\t\tcustomOption.classList.add(\"sketchfab-option\");\r\n\t\t\t\t\t\tvar name = modelList[currentModelIndex].controls[i].configuration.geometries[j].designation;\r\n\t\t\t\t\t\tvar humanReadable = modelList[currentModelIndex].controls[i].configuration.geometries[j].humanReadable;\r\n\t\t\t\t\t\tcustomOption.setAttribute(\"data-value\", name)\r\n\t\t\t\t\t\tcustomOption.id = name + \"-\" + j + \"-\" + i;\r\n\t\t\t\t\t\tcustomOption.innerHTML = name + \" - \" + humanReadable;\r\n\t\t\t\t\t\tif (modelList[currentModelIndex].controls[i].configuration.geometries[j].designation === modelList[currentModelIndex].controls[i].initialValue) {\r\n\t\t\t\t\t\t\tcustomOption.classList.add(\"selected\")\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcustomOption.addEventListener('click', function(e) {\r\n\t\t\t\t\t\t\thandleUpdateSelect(e);\r\n\t\t\t\t\t\t\tdisableAnimations();\r\n\t\t\t\t\t\t\thandleHidingGeometryCombinations();\r\n\t\t\t\t\t\t\tsetVisibleNodes(api);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcustomOptions.appendChild(customOption)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tsingleControlContainer.appendChild(label);\r\n\t\t\t\t\tsingleControlContainer.appendChild(wrapper);\t\t\r\n\t\t\t\t} else if (modelList[currentModelIndex].controls[i].type === \"textureCategory\") {\r\n\t\t\t\t\tnumberOfLowerControls += 1;\r\n\t\t\t\t\tsurfaceConfigurationMode = true\t\t\t\t\t\r\n\t\t\t\t\tconst { geometryName, options, isPrimary, ordering} = modelList[currentModelIndex].controls[i].configuration\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar label = document.createElement(\"h4\");\r\n\t\t\t\t\tlabel.classList.add(\"sketchfab-dropdown-label\");\r\n\t\t\t\t\tlabel.textContent = modelList[currentModelIndex].controls[i].name;\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar controlIndex = i;\r\n\t\t\t\t\tvar wrapper = initializeSelect(controlIndex, geometryName)\r\n\t\t\t\t\twrapper.classList.add(\"sketchfab-texture-category\")\r\n\t\t\t\t\twrapper.id = geometryName + \"-\" + ordering;\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar customOptions = wrapper.querySelector(\".sketchfab-options\")\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (var j=0; j<options.length; ++j) {\r\n\t\t\t\t\t\tlet customOption = document.createElement(\"span\")\r\n\t\t\t\t\t\tcustomOption.classList.add(\"sketchfab-option\");\r\n\t\t\t\t\t\tconst { name, humanReadable } = options[j];\r\n\t\t\t\t\t\tif (name === modelList[currentModelIndex].controls[i].initialValue) {\r\n\t\t\t\t\t\t\tcustomOption.classList.add(\"selected\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcustomOption.setAttribute(\"data-value\", name)\r\n\t\t\t\t\t\tcustomOption.id = name + \"-\" + geometryName + \"-\" + j + \"-\" + j + \"-\" + i;\r\n\t\t\t\t\t\tcustomOption.innerHTML = name + \" - \" + humanReadable;\r\n\t\t\t\t\t\tcustomOption.addEventListener('click', e => {\r\n\t\t\t\t\t\t\thandleUpdateSelect(e);\t\t\t\r\n\t\t\t\t\t\t\thandleHidingTextureCombinations()\r\n\t\t\t\t\t\t\tconfigureMaterials(api) \r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcustomOptions.appendChild(customOption)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tsingleControlContainer.appendChild(label);\r\n\t\t\t\t\tsingleControlContainer.appendChild(wrapper);\r\n\t\t\t\t\t\t\r\n\t\t\t\t} else if (modelList[currentModelIndex].controls[i].type == \"toggle\") {\r\n\t\t\t\t\ttoggleableItems[String(modelList[currentModelIndex].controls[i].entity.instanceID)] = \"visible\";\r\n\t\t\t\t\tvar toggleBut = document.createElement(\"button\");\r\n\t\t\t\t\ttoggleBut.innerHTML = \"Toggle \" + modelList[currentModelIndex].controls[i].name;\r\n\t\t\t\t\ttoggleBut.id = modelList[currentModelIndex].controls[i].entity.instanceID;\r\n\t\t\t\t\ttoggleBut.onclick = function(e) {\r\n\t\t\t\t\t\tvar isVisible = toggleableItems[e.target.id];\r\n\t\t\t\t\t\tif (isVisible == \"visible\") {\r\n\t\t\t\t\t\t\tapi.hide(e.target.id);\r\n\t\t\t\t\t\t\ttoggleableItems[String(modelList[currentModelIndex].controls[i].entity.instanceID)] = \"hidden\";\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tapi.show(e.target.id);\r\n\t\t\t\t\t\t\ttoggleableItems[String(modelList[currentModelIndex].controls[i].entity.instanceID)] = \"visible\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsingleControlContainer.appendChild(toggleBut);\r\n\t\t\t\t}\r\n\t\t\t\tcontrolsContainer.appendChild(singleControlContainer);\r\n\t\t\t}\r\n\t\t\t\r\n\r\n\t\t\tif (isElementCategoryControlled) {\r\n\t\t\t\tsetVisibleNodes(api);\r\n\t\t\t\tdisableAnimations();\r\n\t\t\t\thandleHidingGeometryCombinations();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (animations.length > 0) {\r\n\t\t\t\tpollTime();\t\t\t\r\n\t\t\t}\t\t\t\r\n\t\t\t\r\n\t\t\tif (surfaceConfigurationMode) {\r\n\t\t\t\thandleHidingTextureCombinations()\r\n\t\t\t\tconfigureMaterials(api)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar lowerControlsHeight = (Math.ceil(numberOfLowerControls/2) * 50);\r\n\t\t\tvar controlsHeight = upperControlsContainer.scrollHeight + lowerControlsHeight;\r\n\t\t\t\r\n\t\t\tvar viewerHeight = viewer.scrollHeight;\r\n\t\t\tappContainer.style.height = (controlsHeight + viewerHeight + changeViewerContainer.scrollHeight + 9) + \"px\";\r\n\t\t\tloader.style.top = -1*(loader.scrollHeight + lowerControlsHeight + changeViewerContainer.scrollHeight + 9) + \"px\";\r\n\t\t\t\r\n\t\t\tupperControlsContainer.style.height = (animationButtonContainer.scrollHeight + animationContainerTitle.scrollHeight + 9) + \"px\";\r\n\t\t\t\r\n\t\t\tscreenshotButton.style.display = \"block\";\r\n\t\t\tscreenshotButton.style.top = -1*(lowerControlsHeight + changeViewerContainer.scrollHeight + 12 + screenshotButton.scrollHeight) + \"px\";\r\n\t\t\t\r\n\t\t\t/*NEEDS TO BE SET With css*/\r\n\t\t\tscreenshotButton.style.position = \"relative\";\r\n\t\t\tdocument.querySelector(\".sketchfab-screenshot-modal__content\").style.width = \"541px\";\r\n\t\t\tdocument.querySelector(\".sketchfab-screenshot-modal__content\").style.height = \"615px\";\r\n\t\t\tscreenshotAnchor.style.height = \"35px\";\r\n\t\t\tscreenshotAnchor.style.marginLeft = \"401px\";\r\n\t\t\t\r\n\t\t\twindow.addEventListener('click', function(e) {\r\n\t\t\t\tfor (const select of document.querySelectorAll('.sketchfab-select')) {\r\n\t\t\t\t\tif (!select.contains(e.target)) {\r\n\t\t\t\t\t\tselect.classList.remove('sketchfab-select-open');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n};\r\n\r\nclient.init(modelList[currentModelIndex].uid, {\r\n\tsuccess: success,\r\n\terror: () => generateErrorMessage(),\r\n\tmerge_materials: 1,\r\n\tmaterial_packing: 1,\r\n\tautostart: 1,\r\n\tpreload: 1,\r\n\tui_animations: 0,\r\n\tui_watermark: 0,\r\n\tui_inspector: 0,\r\n\tui_stop: 0,\r\n\tui_infos: 0,\r\n\tui_fullscreen: window.innerWidth < 1000 ? 0 : 1,\r\n});\r\n\r\nvar generateErrorMessage = function() {\r\n\tvar isFirefox = typeof InstallTrigger !== 'undefined';\r\n\tvar isSafari = /constructor/i.test(window.HTMLElement) || (function (p) { return p.toString() === \"[object SafariRemoteNotification]\"; })(!window['safari'] || (typeof safari !== 'undefined' && window['safari'].pushNotification));\r\n\tvar isIE = /*@cc_on!@*/false || !!document.documentMode;\r\n\t\r\n\tvar firefoxSteps = [\r\n\t\t\"Open up the browser menu by clicking the three stacked bars at the top right of the browser window.\",\r\n\t\t\"Select 'Options'.\",\r\n\t\t\"Scroll down until you see the 'Performance' heading.\",\r\n\t\t\"Make sure that the checkbox labeled 'Use recommended performance settings' is checked.\",\r\n\t];\r\n\t\r\n\tvar edgeSteps = [\r\n\t\t\"Open up the browser menu by clicking the three horizontal dots at the top right of the browser window.\",\r\n\t\t\"Click 'Settings'.\",\r\n\t\t\"Click 'System' from the left-hand sidebar.\",\r\n\t\t\"Make sure the second control labeled 'Use hardware acceleration when available' is enabled'.\",\r\n\t\t\"If it appears, click the 'Restart' button.\",\r\n\t];\r\n\t\r\n\tvar chromeSteps = [\r\n\t\t\"Open the Chrome browser menu by clicking on the three vertical dots at the top right of the window.\",\r\n\t\t\"Click on 'Settings'.\",\r\n\t\t\"Click 'Advanced' on the left-hand sidebar.\",\r\n\t\t\"Click 'System'.\",\r\n\t\t\"Make sure the second option is enabled, i.e. 'Use hardware acceleration when available'.\",\r\n\t\t\"If it appears, click the 'Relaunch' button.\"\r\n\t];\r\n\t\r\n\tif (isFirefox) {\r\n\t\tcreateHardwareAccelerationSteps(firefoxSteps);\t\t\r\n\t} else if (navigator.userAgent.includes(\"Edg\")) {\r\n\t\tcreateHardwareAccelerationSteps(edgeSteps);\r\n\t} else {\r\n\t\tcreateHardwareAccelerationSteps(chromeSteps);\r\n\t}\r\n\t\t\r\n\tchangeViewerContainer.style.display = \"none\";\r\n\terrorMessage.style.display = \"flex\";\r\n\r\n\tloader.style.display = \"none\";\r\n\tconsole.error('Sketchfab API error');\r\n}\r\n\r\nvar createHardwareAccelerationSteps = function(stepsArray) {\r\n\tconsole.log(stepsArray);\r\n\tvar hardwareAccelerationStepsContainer = document.querySelector(\"#sketchfab-hardware-acceleration-steps\");\r\n\tfor (var i=0; i<stepsArray.length; ++i) {\r\n\t\tvar step = document.createElement(\"li\");\r\n\t\tstep.textContent = stepsArray[i];\r\n\t\tconsole.log(stepsArray[i]);\r\n\t\thardwareAccelerationStepsContainer.appendChild(step);\r\n\t}\r\n}\r\n\r\nvar handleHidingTextureCombinations = function(api) {\r\n\tconsole.log(\"BEGIN: handleHidingTextureCombinations\")\r\n\t\r\n\tvar textureSelects = document.getElementsByClassName(\"sketchfab-texture-category\")\t\r\n\tfor (var i=0; i<textureSelects.length; ++i) {\r\n\t\tvar options = textureSelects[i].getElementsByClassName(\"sketchfab-option\");\r\n\t\tvar geometryName = textureSelects[i].id.split(\"-\")[0]\r\n\t\tvar ordering = textureSelects[i].id.split(\"-\")[1]\r\n\t\tvar isPrimary = Number(ordering) === 0;\r\n\t\tif (!isPrimary) {\r\n\t\t\tvar currentInitialPrimarySelection = document.getElementById(geometryName + \"-0\").querySelector(\".sketchfab-select__trigger span\").textContent;\r\n\t\t\tvar availableOptions = modelList[currentModelIndex].surfaceOptionMap[geometryName][currentInitialPrimarySelection][ordering-1].sort()\r\n\t\t\tvar previouslyAvailableOptions =  Array.from(options).filter(op => op.style.display === \"block\").map(op => op.getAttribute(\"data-value\")).sort()\r\n\t\t\tlet equal = availableOptions.length == previouslyAvailableOptions.length && availableOptions.every((element, index)=> element === previouslyAvailableOptions[index] );\r\n\t\t\t\r\n\t\t\tvar triggerSpan = textureSelects[i].querySelector(\".sketchfab-select__trigger span\")\r\n\t\t\t\r\n\t\t\tif (!equal) {\r\n\t\t\t\tvar newValueSet = false;\r\n\t\t\t\tfor (var j=0; j<options.length; ++j) {\r\n\t\t\t\t\toptions[j].classList.remove(\"selected\")\r\n\t\t\t\t\tvar optionValue = options[j].getAttribute(\"data-value\")\r\n\t\t\t\t\toptions[j].style.display = \"none\"\r\n\t\t\t\t\tvar optionValue = options[j].getAttribute(\"data-value\")\r\n\t\t\t\t\tif (availableOptions.includes(optionValue)) {\r\n\t\t\t\t\t\toptions[j].style.display = \"block\"\r\n\t\t\t\t\t\tif (!newValueSet) {\r\n\t\t\t\t\t\t\ttriggerSpan.textContent = optionValue;\r\n\t\t\t\t\t\t\toptions[j].classList.add(\"selected\")\r\n\t\t\t\t\t\t\tnewValueSet = true;\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconsole.log(\"END: handleHidingTextureCombinations\")\r\n}\r\n\r\nvar configureMaterials = function(api) {\r\n\tconsole.log(\"BEGIN: configureMaterials\")\r\n\tvar textureSelects = document.getElementsByClassName(\"sketchfab-texture-category\")\t\r\n\tfor (var i=0; i<textureSelects.length; ++i) {\r\n\t\tvar geometryName = textureSelects[i].id.split(\"-\")[0]\r\n\t\t//get array of selected values\r\n\t\tvar relevantSelects = document.getElementsByClassName(geometryName + \"-triggerSpan\")\r\n\t\t//build name string via accessing selected values\r\n\t\tvar materialNameString = geometryName + \"-\";\r\n\t\t\r\n\t\tfor (var j=0; j<relevantSelects.length; ++j) {\r\n\t\t\tmaterialNameString += relevantSelects[j].textContent + \"-\";\r\n\t\t}\r\n\t\tvar newMaterial;\r\n\t\tfor (var j=0; j<modelList[currentModelIndex].materials.length; ++j) {\r\n\t\t\tif (modelList[currentModelIndex].materials[j].name.startsWith(materialNameString)) {\r\n\t\t\t\tnewMaterial = JSON.parse(JSON.stringify(modelList[currentModelIndex].materials[j]));\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tfor (var j=0; j<modelList[currentModelIndex].materials.length; ++j) {\r\n\t\t\tif (modelList[currentModelIndex].materials[j].name === geometryName) {\r\n\t\t\t\tmodelList[currentModelIndex].materials[j].channels = JSON.parse(JSON.stringify(newMaterial.channels));\r\n\t\t\t\tmodelList[currentModelIndex].materials[j].reflection = newMaterial.reflection;\r\n\t\t\t\tmodelList[currentModelIndex].materials[j].reflector = newMaterial.reflector;\r\n\t\t\t\tmodelList[currentModelIndex].materials[j].shadeless = newMaterial.shadeless;\r\n\t\t\t\tapi.setMaterial(modelList[currentModelIndex].materials[j], function() {console.log(\"material updated\")})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tconsole.log(\"END: configureMaterials\")\r\n}\r\n\r\nvar setVisibleNodes = function(api) {\r\n\tconsole.log(\"BEGIN: setVisibleNotes\")\r\n\tvar allCategorySelects = document.querySelectorAll(\".sketchfab-geometry-category span.sketchfab-select-value\")\r\n\tvar selectedPrefixes = [];\r\n\t\r\n\tvar lettersByDesignation = {};\r\n\tfor (var i=0; i<allCategorySelects.length; ++i) {\r\n\t\tselectedPrefixes.push(allCategorySelects[i].textContent);\r\n\t\tlettersByDesignation[selectedPrefixes[i]] = []\r\n\t}\r\n\t\r\n\tvar relevantNodes = [];\r\n\t\r\n\tfor (var i=0; i<modelList[currentModelIndex].sceneGraph.length; ++i) {\r\n\t\tvar indexContainingCodes = i;\r\n\t\tif (modelList[currentModelIndex].sceneGraph[i].name === \"MatrixTransform\") {\r\n\t\t\tif (modelList[currentModelIndex].sceneGraph[i].depth < 3) {\r\n\t\t\t\tindexContainingCodes = i + 1;\r\n\t\t\t} else {\r\n\t\t\t\tindexContainingCodes = i - 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tvar nodeNameArray = modelList[currentModelIndex].sceneGraph[indexContainingCodes].name.split(\"-\")\r\n\t\tvar currentNodeDesignation = nodeNameArray[0];\r\n\t\tvar currentNodeLetterCode = nodeNameArray[1];\r\n\t\t\r\n\t\tif (currentNodeDesignation !== \"AlwaysOn\") {\r\n\t\t\tapi.hide(modelList[currentModelIndex].sceneGraph[indexContainingCodes].instanceID);\r\n\t\t}\t\t\t\t\t\t\r\n\t\t\r\n\t\tif (selectedPrefixes.includes(currentNodeDesignation)) {\r\n\t\t\tfor (var j=0; j<currentNodeLetterCode.length; ++j) {\r\n\t\t\t\tif (lettersByDesignation[currentNodeDesignation].indexOf(currentNodeLetterCode[j]) === -1) {\r\n\t\t\t\t\tlettersByDesignation[currentNodeDesignation].push(currentNodeLetterCode[j])\r\n\t\t\t\t}\t\r\n\t\t\t}\t\t\r\n\t\t\t\r\n\t\t\trelevantNodes.push({\r\n\t\t\t\tletterCode: currentNodeLetterCode, \r\n\t\t\t\tinstanceID: modelList[currentModelIndex].sceneGraph[i].instanceID, \r\n\t\t\t\tname: modelList[currentModelIndex].sceneGraph[i].name, \r\n\t\t\t\tupstreamRelevantNodes: collectUpstreamNodes(i),\r\n\t\t\t\tboneNodes: collectBoneNodes(i),\r\n\t\t\t})\t\t\r\n\t\t}\r\n\t}\t\t\r\n\t\r\n\tvar letters = [];\r\n\tvar commonLetter = \"\"\r\n\tfor (var i=0; i<Object.values(lettersByDesignation).length; ++i) {\r\n\t\tif (Object.values(lettersByDesignation)[i].length === 1) {\r\n\t\t\tcommonLetter = Object.values(lettersByDesignation)[i][0]\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tletters = letters.concat(Object.values(lettersByDesignation)[i])\r\n\t\tcommonLetter = mode(letters)[0]\r\n\t}\r\n\tfor (var i=0; i<relevantNodes.length; ++i) {\r\n\t\tif (relevantNodes[i].letterCode.indexOf(commonLetter) != -1) {\r\n\t\t\tapi.show(relevantNodes[i].instanceID);\r\n\t\t\tfor (var j=0; j<relevantNodes[i].upstreamRelevantNodes.length; ++j) {\r\n\t\t\t\tapi.show(relevantNodes[i].upstreamRelevantNodes[j].instanceID)\r\n\t\t\t}\r\n\t\t\tfor (var j=0; j<relevantNodes[i].boneNodes.length; ++j) {\r\n\t\t\t\tapi.show(relevantNodes[i].boneNodes[j].instanceID);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tconsole.log(\"END: setVisibleNodes\")\r\n}\r\n\r\nvar collectUpstreamNodes = function(nodeIndex) {\r\n\tvar nodeNameArray = modelList[currentModelIndex].sceneGraph[nodeIndex].name.split(\"-\")\r\n\tvar initialNodeDesignation = nodeNameArray[0];\r\n\t\t\t\r\n\tvar currentUpstreamDepth = Number(modelList[currentModelIndex].sceneGraph[nodeIndex].depth)\r\n\tvar currentUpstreamIndex = nodeIndex - 1;\r\n\tvar upstreamRelevantNodes = []\r\n\twhile(currentUpstreamDepth > 1) {\r\n\t\tif (modelList[currentModelIndex].sceneGraph[currentUpstreamIndex].depth < currentUpstreamDepth) {\r\n\t\t\tvar currentUpstreamDesignation = modelList[currentModelIndex].sceneGraph[currentUpstreamIndex].name.split(\"-\")[0]\r\n\t\t\tvar currentUpstreamLetterCode = modelList[currentModelIndex].sceneGraph[currentUpstreamIndex].name.split(\"-\")[1]\r\n\t\t\tif (currentUpstreamDesignation !== initialNodeDesignation) {\r\n\t\t\t\tupstreamRelevantNodes.push({\r\n\t\t\t\t\tletterCode: currentUpstreamLetterCode, \r\n\t\t\t\t\tinstanceID: modelList[currentModelIndex].sceneGraph[currentUpstreamIndex].instanceID, \r\n\t\t\t\t\tname: modelList[currentModelIndex].sceneGraph[currentUpstreamIndex].name\r\n\t\t\t\t})\r\n\t\t\t}\t\r\n\t\t\tcurrentUpstreamDepth = Number(modelList[currentModelIndex].sceneGraph[currentUpstreamIndex].depth);\r\n\t\t}\r\n\t\tcurrentUpstreamIndex = currentUpstreamIndex - 1;\r\n\t}\r\n\r\n\treturn upstreamRelevantNodes;\r\n}\r\n\r\nvar collectBoneNodes = function(nodeIndex) {\r\n\t\r\n\tvar downStreamRelevantNodes = []\r\n\tif (modelList[currentModelIndex].sceneGraph[nodeIndex].type === \"Group\") {\r\n\t\tvar currentDownstreamIndex = nodeIndex + 1;\r\n\t\tvar initialDepth = Number(modelList[currentModelIndex].sceneGraph[nodeIndex].depth)\r\n\t\tvar currentDownstreamDepth = Number(modelList[currentModelIndex].sceneGraph[currentDownstreamIndex].depth)\r\n\t\twhile(currentDownstreamDepth>initialDepth && modelList[currentModelIndex].sceneGraph[currentDownstreamIndex] !== undefined) {\r\n\t\t\tvar currentDownStreamNode = {\r\n\t\t\t\tletterCode: \"NA\", \r\n\t\t\t\tinstanceID: modelList[currentModelIndex].sceneGraph[currentDownstreamIndex].instanceID, \r\n\t\t\t\tname: \"NA\", \r\n\t\t\t\tupstreamRelevantNodes: [],\r\n\t\t\t}\r\n\t\t\tdownStreamRelevantNodes.push(currentDownStreamNode)\t\r\n\t\t\tcurrentDownstreamDepth = modelList[currentModelIndex].sceneGraph[currentDownstreamIndex].depth;\r\n\t\t\tcurrentDownstreamIndex += 1;\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn downStreamRelevantNodes;\r\n}\r\nvar mode = function(arr) { \r\n\tif(arr.filter((x,index) => arr.indexOf(x) == index).length == arr.length) {\r\n\t\treturn arr; \r\n\t} else {\r\n\t\treturn mode(arr.sort((x,index)=>x-index).map((x,index)=>arr.indexOf(x)!=index ? x : null ).filter(x=>x!=null))\r\n\t}\t\t\r\n}\r\n\r\nvar handleUpdateSelect = function(e) {\r\n\tconsole.log(\"BEGIN: handleUpdateSelect\")\r\n\tvar nameCode = e.target.id.split(\"-\")[0]\r\n\t\r\n\tif (!e.target.classList.contains('selected')) {\r\n\t\t\r\n\t\te.target.parentNode.querySelector('.sketchfab-option.selected').classList.remove('selected');\r\n\t\te.target.classList.add('selected');\r\n\t\te.target.closest('.sketchfab-select').querySelector('.sketchfab-select__trigger span').textContent = nameCode;\t\t\t\t\t\t\t\t\r\n\t}\r\n\tconsole.log(\"END: handleUpdateSelect\")\r\n}\r\n\r\nvar handleHidingGeometryCombinations = function() {\r\n\tconsole.log(\"BEGIN: handleHidingGeometryCombinations\")\r\n\t\t\t\t\r\n\tvar allCategoryOptions = document.querySelectorAll(\".sketchfab-geometry-category .sketchfab-option\")\r\n\tvar currentCategorySelections = Array.from(document.querySelectorAll(\".sketchfab-geometry-category .sketchfab-select\"))\r\n\t\t\t\t\t\t\t.map(select => select.querySelector(\".sketchfab-select-value\").textContent)\r\n\t\t\t\t\t\t\t\r\n\tvar allGeoSelects = document.getElementsByClassName(\"sketchfab-geometry-category\")\r\n\t\t\t\t\t\t\t\r\n\tvar geometryControls = modelList[currentModelIndex].controls.filter(control => control.type === \"geometryCategory\")\r\n\r\n\tvar disabledOptions = []\r\n\tvar disabledControls = []\r\n\tfor(var i=0; i<geometryControls.length; ++i) {\r\n\t\tvar hiddenValues = geometryControls[i].configuration.geometries.filter(geometry => geometry.designation === currentCategorySelections[i])[0].hiddenValues;\r\n\t\tvar disabledValues = geometryControls[i].configuration.geometries.filter(geometry => geometry.designation === currentCategorySelections[i])[0].disabledTextureControls;\r\n\t\tconsole.log(\"geometryControls[\" + i + \"]:\")\r\n\t\tconsole.log(geometryControls[i])\r\n\t\tdisabledOptions = disabledOptions.concat(hiddenValues)\r\n\t\tdisabledControls = disabledControls.concat(disabledValues)\r\n\t}\r\n\t\r\n\tfor (var i=0; i<allCategoryOptions.length; ++i) {\r\n\t\tallCategoryOptions[i].style.display = \"block\";\r\n\t\tif (disabledOptions.includes(allCategoryOptions[i].getAttribute(\"data-value\"))) {\r\n\t\t\tallCategoryOptions[i].style.display = \"none\"\r\n\t\t}\r\n\t}\r\n\t\r\n\tfor (var i=0; i<currentCategorySelections.length; ++i) {\r\n\t\tif (disabledOptions.includes(currentCategorySelections[i])) {\r\n\t\t\tfor(var j=0; j<allGeoSelects[i].querySelectorAll(\".sketchfab-option\").length; ++j) {\r\n\t\t\t\tif (allGeoSelects[i].querySelectorAll(\".sketchfab-option\")[j].style.display === \"block\") {\r\n\t\t\t\t\tallGeoSelects[i].querySelector(\".sketchfab-select-value\").textContent = allGeoSelects[i].querySelectorAll(\".sketchfab-option\")[j].getAttribute(\"data-value\")\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tvar dropdownControls = document.querySelectorAll(\".sketchfab-single-control-container\")\r\n\tvar nonCategoryControlOffset = 0;\r\n\tfor (var i=0; i<modelList[currentModelIndex].controls.length; ++i) {\r\n\t\tglobalDisabledControls[i] = false;\r\n\t\tif (modelList[currentModelIndex].controls[i].type.includes(\"Category\")) {\r\n\t\t\tdocument.querySelectorAll(\".sketchfab-single-control-container\")[i-nonCategoryControlOffset].style.opacity = 1;\r\n\t\t\tif (disabledControls.includes(modelList[currentModelIndex].controls[i].name)) {\r\n\t\t\t\tglobalDisabledControls[i] = true;\r\n\t\t\t\tdocument.querySelectorAll(\".sketchfab-single-control-container\")[i-nonCategoryControlOffset].style.opacity = 0.3;\t\t\t\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tnonCategoryControlOffset += 1;\r\n\t\t}\r\n\t}\r\n\tconsole.log(\"END: handleHidingGeometryCombinations\")\r\n}\r\n\r\nvar disableAnimations = function() {\t\t\r\n\tvar allCategorySelects = document.querySelectorAll(\".sketchfab-geometry-category span.sketchfab-select-value\")\r\n\tvar allowAnimations = true;\r\n\tfor (var i=0; i<allCategorySelects.length; ++i) {\r\n\t\tvar controlIndex = allCategorySelects[i].id.split(\"-\")[1]\r\n\t\tvar currentNameCode = allCategorySelects[i].textContent;\r\n\t\tfor (var j=0; j<modelList[currentModelIndex].controls[controlIndex].configuration.geometries.length; ++j) {\r\n\t\t\tif (modelList[currentModelIndex].controls[controlIndex].configuration.geometries[j].designation === currentNameCode) {\r\n\t\t\t\tif (modelList[currentModelIndex].controls[controlIndex].configuration.geometries[j].allowsAnimation === false) {\r\n\t\t\t\t\tallowAnimations = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tvar animationButtons = document.querySelectorAll(\"#sketchfab-animation-buttons button\")\r\n\t\r\n\tfor (var i=0; i<animationButtons.length; ++i) {\r\n\t\tanimationButtons[i].disabled = true;\r\n\t}\r\n\t\r\n\tvar initiallyDisabled = animationsEnabled === false\r\n\t\r\n\tanimationsEnabled = false;\r\n\tif (allowAnimations) {\r\n\t\tfor (var i=0; i<animationButtons.length; ++i) {\r\n\t\t\tif (animationButtons[i].textContent !== modelList[currentModelIndex].controls[currentAnimationIndex].name) {\r\n\t\t\t\tanimationButtons[i].disabled = false;\r\n\t\t\t}\r\n\t\t}\t\r\n\t\tanimationsEnabled = true;\r\n\t\tif (initiallyDisabled) {\r\n\t\t\tvar animationUID = Object.values(animationObjects)[0].uid\r\n\t\t\tapiSkfb.setCurrentAnimationByUID(animationUID);\r\n\t\t\tpollTime();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nvar initializeSelect = function(controlIndex, geometryName=\"\") {\r\n\tconsole.log(\"BEGIN: initializeSelect:\")\r\n\r\n\tvar wrapper = document.createElement(\"div\")\r\n\twrapper.classList.add(\"sketchfab-select-wrapper\")\t\r\n\tvar appWidth = Number(appContainer.clientWidth)\r\n\twrapper.style.width = (appWidth/2) + \"px\";\r\n\t\r\n\tvar select = document.createElement(\"div\")\r\n\tselect.classList.add(\"sketchfab-select\")\r\n\t\r\n\tvar selectTrigger = document.createElement(\"div\")\r\n\tselectTrigger.classList.add(\"sketchfab-select__trigger\")\r\n\t\r\n\tvar triggerSpan = document.createElement(\"span\")\r\n\ttriggerSpan.id = \"triggerSpan-\" + controlIndex;\r\n\ttriggerSpan.classList.add(\"sketchfab-select-value\")\r\n\ttriggerSpan.classList.add(geometryName + \"-triggerSpan\")\r\n\ttriggerSpan.textContent = modelList[currentModelIndex].controls[controlIndex].initialValue;\r\n\t\r\n\tvar arrow = document.createElement(\"div\")\r\n\tarrow.classList.add(\"sketchfab-select-arrow\")\r\n\t\r\n\tvar customOptions = document.createElement(\"div\")\r\n\tcustomOptions.classList.add(\"sketchfab-options\")\r\n\t\r\n\tselectTrigger.appendChild(triggerSpan)\r\n\tselectTrigger.appendChild(arrow)\r\n\tselect.appendChild(selectTrigger)\r\n\tselect.appendChild(customOptions)\r\n\twrapper.appendChild(select)\t\r\n\r\n\twrapper.addEventListener('click', function() {\r\n\t\tconsole.log(\"BEGIN: wrapper click\");\r\n\t\tvar index = this.querySelector(\".sketchfab-select-value\").id.split(\"-\")[1]\r\n\t\tif (globalDisabledControls[index] === false) {\r\n\t\t\tthis.querySelector('.sketchfab-select').classList.toggle('sketchfab-select-open');\t\r\n\t\t}\r\n\t\tconsole.log(\"END: wrapper click\");\r\n\t})\r\n\t\r\n\treturn wrapper;\r\n\tconsole.log(\"END: initializeSelect:\")\r\n}\r\n\r\nif (modelList.length > 1) {\r\n\tfor (var i = 0; i<modelList.length; ++i) {\r\n\t\tconsole.log(\"modelList:\")\r\n\t\tconsole.log(modelList)\r\n\t\tvar viewerButton = document.createElement(\"button\");\r\n\t\tviewerButton.id = \"index\" + \"-\" + i;\r\n\t\tviewerButton.classList.add(\"view-change__button\")\r\n\t\tviewerButton.textContent = modelList[i].name;\r\n\t\tif (currentModelIndex === i) {\t\r\n\t\t\tviewerButton.disabled = true;\r\n\t\t}\r\n\t\tviewerButton.addEventListener(\"click\", function() {\r\n\t\t\tvar viewChangeButtons = document.querySelectorAll(\".view-change__button\")\r\n\t\t\tfor (var j=0; j<viewChangeButtons.length; ++j) {\r\n\t\t\t\tviewChangeButtons[j].disabled = false;\r\n\t\t\t}\r\n\t\t\tthis.disabled = true;\r\n\t\t\t\r\n\t\t\tcontrolsContainer.innerHTML = null;\r\n\r\n\t\t\tanimationButtonContainer.innerHTML = null;\r\n\t\t\tanimationContainerTitle.style.display = \"none\";\r\n\t\t\tvar index = this.id.split(\"-\")[1]\r\n\t\t\tapiSkfb.stop();\r\n\t\t\tloaderTitle.textContent = modelList[index].name;\r\n\t\t\tcurrentModelIndex = index;\r\n\r\n\t\t\tisElementCategoryControlled = false;\r\n\t\t\tsurfaceConfigurationMode = false;\r\n\r\n\t\t\tanimationObjects = {};\r\n\t\t\ttoggleableItems = {};\r\n\t\t\tcurrentAnimationIndex = 0;\r\n\t\t\tcurrentAnimationEndTime = 0;\r\n\r\n\t\t\tglobalDisabledControls = [];\r\n\r\n\t\t\tanimationsEnabled = false;\r\n\t\t\t\r\n\t\t\tnumberOfLowerControls = 0;\r\n\t\t\tloader.style.display = \"flex\";\r\n\t\t\tloader.style.top = -1*(loader.scrollHeight + changeViewerContainer.scrollHeight + 9) + \"px\";\r\n\r\n\t\t\tclient.init(modelList[index].uid, {\r\n\t\t\t\tsuccess: success,\r\n\t\t\t\terror: generateErrorMessage,\r\n\t\t\t\tmerge_materials: 1,\r\n\t\t\t\tmaterial_packing: 1,\r\n\t\t\t\tautostart: 1,\r\n\t\t\t\tpreload: 0,\r\n\t\t\t\tui_animations: 0,\r\n\t\t\t\tui_watermark: 0,\r\n\t\t\t\tui_inspector: 0,\r\n\t\t\t\tui_stop: 0,\r\n\t\t\t\tui_infos: 0,\r\n\t\t\t});\r\n\t\t});\r\n\t\tchangeViewerContainer.appendChild(viewerButton);\r\n\t}\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n`\r\n)\r\n}\r\n\r\nexport default ExportModal;\r\n","import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { \r\n    createControl, \r\n    toggleOptionChoiceModalDisplay,\r\n    selectSurfaceConfigurationMode,\r\n    setSurfaceConfigurationMode,\r\n    addTextureControls,\r\n} from './viewerSlice';\r\n\r\nconst OptionChoiceModal = () => {\r\n    const dispatch = useDispatch();\r\n    const isSurfaceConfigurationMode = false //useSelector(selectSurfaceConfigurationMode)\r\n\r\n    return (\r\n        <div id=\"control-choice-modal\">\r\n            <div className=\"control-choice-content\">\r\n                <div \r\n                    className=\"control-choice\" \r\n                    style={{color: \"red\"}}\r\n                    onClick={() => {\r\n                        dispatch(createControl(\"animation\"));\r\n                        dispatch(toggleOptionChoiceModalDisplay());\r\n                    }}\r\n                >Animation</div>\r\n                <div \r\n                    className=\"control-choice\" \r\n                    style={{color: \"yellow\"}}\r\n                    onClick={() => {\r\n                        dispatch(createControl(\"color\"));\r\n                        dispatch(toggleOptionChoiceModalDisplay());\r\n                    }}\r\n                >Color</div>\r\n                <div \r\n                    className=\"control-choice\" \r\n                    style={{color: \"blue\"}}\r\n                    onClick={() => {\r\n                        dispatch(createControl(\"geometryCategory\"));\r\n                        dispatch(toggleOptionChoiceModalDisplay());\r\n                    }}\r\n                >Geometry Category</div>\r\n                <div \r\n                    className=\"control-choice\" \r\n                    style={{visibility: isSurfaceConfigurationMode ? \"hidden\" : \"visible\", color: \"green\"}}\r\n                    onClick={() => {\r\n                        if (isSurfaceConfigurationMode === false) {\r\n                            dispatch(toggleOptionChoiceModalDisplay());\r\n                            dispatch(addTextureControls())\r\n                            dispatch(setSurfaceConfigurationMode(true))\r\n                        }\r\n                    }}\r\n                >Texture Configuration</div>\r\n                <div \r\n                    className=\"control-choice\" \r\n                    style={{color: \"purple\"}}\r\n                    onClick={() => {\r\n                        dispatch(createControl(\"toggle\"));\r\n                        dispatch(toggleOptionChoiceModalDisplay());\r\n                    }}\r\n                >Toggle</div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default OptionChoiceModal;\r\n","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { \r\n  selectAnimations,\r\n  selectControls,\r\n  updateControl,\r\n} from './viewerSlice';\r\n\r\nconst AnimationPanel = props => {           \r\n    const dispatch = useDispatch();\r\n    const { option } = props;\r\n    const animations = useSelector(selectAnimations);\r\n    const controls = useSelector(selectControls)\r\n\r\n    const animationOptions = animations.map(animation => <option value={animation[0]}>{animation[1]}</option>)\r\n    animationOptions.unshift(<option value=\"none\">Select an Animation</option>)\r\n\r\n    return (\r\n      <div style={{display: \"flex\", alignItems: \"flex-start\", flexDirection: \"column\"}}>\r\n        <div style={{display: \"flex\"}}>\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={option.configuration.isDisabledInitially}\r\n            onChange={(e) => {\r\n              const currentlyDisabled = option.configuration.isDisabledInitially;\r\n              for (let i=0; i<controls.length; ++i) {\r\n                let newXConfiguration = {\r\n                  ...controls[i].configuration,\r\n                  isDisabledInitially: false,\r\n                }\r\n                dispatch(updateControl({id: controls[i].id, key: \"configuration\", value: newXConfiguration}))\r\n              }\r\n              let newConfiguration = {\r\n                ...option.configuration,\r\n                isDisabledInitially: !currentlyDisabled,\r\n              }\r\n              dispatch(updateControl({id: option.id, key: \"configuration\", value: newConfiguration}))\r\n            }}\r\n          />\r\n          <div>Disable Initially</div>\r\n        </div>\r\n        <div>\r\n          <label>Animation:</label>\r\n          <select \r\n            name=\"animationSelect\"\r\n            value={option.configuration.animationUID}\r\n            onChange={(e) => {\r\n              let newConfiguration = {\r\n                ...option.configuration,\r\n                animationUID: e.target.value,\r\n                animationName: e.target.options[e.target.selectedIndex].textContent,\r\n              }\r\n              dispatch(updateControl({id: option.id, key: \"configuration\", value: newConfiguration}))\r\n            }}\r\n          >\r\n            {animationOptions}\r\n          </select>\r\n        </div>\r\n        <div>\r\n          <label htmlFor=\"start\">Start Time:</label>\r\n          <input \r\n            type=\"number\" \r\n            name=\"start\"\r\n            value={option.configuration.startTime} \r\n            onChange={(e) => {\r\n              let newConfiguration = {\r\n                ...option.configuration,\r\n                startTime: e.target.value,\r\n              }\r\n              dispatch(updateControl({id: option.id, key: \"configuration\", value: newConfiguration}))}\r\n            }\r\n          />\r\n        </div>\r\n        <div>\r\n          <label htmlFor=\"end\">End Time:</label>\r\n          <input \r\n            type=\"number\" \r\n            name=\"end\"\r\n            value={option.configuration.endTime} \r\n            onChange={(e) => {\r\n              let newConfiguration = {\r\n                ...option.configuration,\r\n                endTime: e.target.value,\r\n              }\r\n              dispatch(updateControl({id: option.id, key: \"configuration\", value: newConfiguration}))}\r\n            }\r\n          />\r\n        </div>\r\n      </div>\r\n    )\r\n}\r\n\r\nexport default AnimationPanel;\r\n","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { \r\n  selectMaterials, \r\n  updateControl,\r\n} from './viewerSlice';\r\nimport hexRgb from 'hex-rgb';\r\n\r\nconst ColorPanel = props => {\r\n\r\n    const dispatch = useDispatch(); \r\n    const { option } = props\r\n    const materials = useSelector(selectMaterials); \r\n\r\n    return (\r\n    <div>\r\n      <div className=\"input__container\">\r\n        <label htmlFor=\"materials\">Material:</label>\r\n        {renderColorsOption(option, materials, dispatch)}\r\n      </div>\r\n      <div className=\"additional-color__container\" id={`${option.id}-additionalColors`}>\r\n        {renderAdditionalColors(option.id, option.additionalColors, dispatch)}\r\n      </div>\r\n      <div className=\"input__container\">\r\n        <button \r\n          id=\"addColor\"\r\n          className=\"add__button\"\r\n          onClick={() => {\r\n            if(option.additionalColors === undefined || option.additionalColors === null) {\r\n                const transferObject = {\r\n                  id: option.id, \r\n                  key: \"additionalColors\", \r\n                  value: [{color:\"#ffffff\", name: \"white\", colorRGB: [1,1,1]}]\r\n                };\r\n                \r\n                dispatch(updateControl(transferObject));\r\n            } else {\r\n              let newColors = [];\r\n              for (let i = 0; i<option.additionalColors.length; ++i) {\r\n                newColors[i] = option.additionalColors[i];\r\n              }\r\n              newColors.push({color: \"#ffffff\", name: \"default\", colorRGB: [1,1,1]});\r\n              dispatch(updateControl({id: option.id, key: \"additionalColors\", value: newColors}));\r\n            }\r\n          }}\r\n        >+ Add Color</button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n  \r\nconst renderAdditionalColors = (id, additionalColors, dispatch) => {\r\n    if (additionalColors == null || additionalColors == undefined) {\r\n      return <div></div>\r\n    } else {\r\n      return additionalColors.map((color, index, array) => (\r\n        <div className=\"input__container\">\r\n          <label htmlFor=\"defaultColor\">Alternate Color:</label>\r\n          <input \r\n            type=\"color\" \r\n            name=\"additionalColor\" \r\n            id={`${id}-${index}-additionalColor`} \r\n            value={additionalColors[index].color}\r\n            onChange={(e) => {\r\n              const newArray = [];\r\n              for (let i=0; i<array.length; ++i) {\r\n                const newColor = {};\r\n                if (i === index) {\r\n                  newColor.color = e.target.value;\r\n                  newColor.colorRGB = hexRgb(e.target.value, {format: 'array'}).map(num => num/255);\r\n                  newColor.name = array[i].name;\r\n                } else {\r\n                  newColor.color = array[i].color;\r\n                  newColor.colorRGB = array[i].colorRGB;\r\n                  newColor.name = array[i].name;\r\n                }\r\n                newArray[i] = newColor;\r\n              }\r\n              dispatch(updateControl({id: id, key: \"additionalColors\", value: newArray}));\r\n            }}      \r\n          />\r\n          <input\r\n            type=\"text\"\r\n            value={additionalColors[index].name}\r\n            onChange={(e) => {\r\n              const newArray = [];\r\n              for (let i=0; i<array.length; ++i) {\r\n                const newColor = {};\r\n                if (i === index) {\r\n                  newColor.color = array[i].color;\r\n                  newColor.colorRGB = array[i].colorRGB;\r\n                  newColor.name = e.target.value;\r\n                } else {\r\n                  newColor.color = array[i].color;\r\n                  newColor.colorRGB = array[i].colorRGB;\r\n                  newColor.name = array[i].name;\r\n                }\r\n                newArray[i] = newColor;\r\n              }\r\n              dispatch(updateControl({id: id, key: \"additionalColors\", value: newArray}));\r\n            }}      \r\n          />\r\n        </div>\r\n      ))\r\n    }\r\n  }\r\n  \r\nconst renderColorsOption = (option, materials, dispatch) => {\r\n  \r\n    const materialsHtml = materials.map((material, index) => <option value={index}>{material.name}</option>)\r\n    materialsHtml.unshift(<option value=\"none\">Select a Material</option>)\r\n\r\n    return (\r\n      <select \r\n        name=\"materials\" \r\n        id=\"materials\"\r\n        onChange={(e) => {\r\n          dispatch(updateControl({id: option.id, key: \"entityIndex\", value: e.target.value }));\r\n          dispatch(updateControl({id: option.id, key: \"entity\", value: materials[e.target.value] }));\r\n        }}\r\n        value={option.entityIndex}\r\n      >\r\n        {materialsHtml}\r\n      </select>\r\n    )\r\n}\r\n\r\nexport default ColorPanel;\r\n","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { \r\n  selectGeometryCategoryOptions,\r\n  selectControls,\r\n  setUnselectedGeometries,\r\n  updateControl,\r\n} from './viewerSlice';\r\nimport { ReactSortable } from 'react-sortablejs';\r\n\r\nconst GeometryCategoryPanel = props => {\r\n\r\n    const dispatch = useDispatch();\r\n    const { option } = props;\r\n    const unselectedGeometries = useSelector(selectGeometryCategoryOptions);\r\n    const selectedGeometries = option.configuration.geometries;\r\n    const controls = useSelector(selectControls)\r\n\r\n    const renderUnselectedGeometryMultiselect = () => unselectedGeometries.map((geometry, index) => (\r\n            <div \r\n              key={`element-${option.id}-${index}`} \r\n              className=\"geometry-option\"\r\n              style={{display: \"flex\"}} \r\n              onClick={() => {\r\n                let newUnselectedGeometries = JSON.parse(JSON.stringify(unselectedGeometries))\r\n                let selectedGeometry = newUnselectedGeometries.splice(index, 1)[0]\r\n                selectedGeometry.disabledTextureControls = []\r\n                let newConfiguration = JSON.parse(JSON.stringify(option.configuration))\r\n                newConfiguration.geometries.push(selectedGeometry)\r\n                dispatch(updateControl({ id: option.id, key: \"configuration\", value: newConfiguration }))\r\n                dispatch(setUnselectedGeometries(newUnselectedGeometries))\r\n              }}\r\n            >\r\n              <div>{geometry.designation}</div>\r\n            </div>\r\n          ))\r\n\r\n    const renderSelectedGeometryMultiselect = () => {     \r\n\r\n      return selectedGeometries.map((geometry, index) => {\r\n        \r\n        return (\r\n          <div style={{display: \"flex\"}}>\r\n          <div key={`element-${option.id}-${index}`}>\r\n            <div style={{display: \"flex\"}}>\r\n              <div style={{display: \"flex\", flex: \"1 1 auto\", fontWeight: \"bold\"}}>\r\n                <div>{geometry.designation}</div>\r\n              </div>\r\n              <div>Animation:</div>\r\n              <input \r\n                type=\"checkbox\" \r\n                checked={geometry.allowsAnimation}\r\n                onChange={() => {\r\n                  let newGeometries = JSON.parse(JSON.stringify(selectedGeometries))\r\n                  newGeometries[index].allowsAnimation = !geometry.allowsAnimation;\r\n                  setSelectedGeometries(newGeometries)\r\n                }}\r\n              />\r\n            </div>\r\n            <div style={{display: \"flex\"}}>\r\n              <div>Name:</div>\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Enter human readable name\"\r\n                value={geometry.humanReadable}\r\n                onChange={e => {\r\n                  let newGeometries = JSON.parse(JSON.stringify(selectedGeometries))\r\n                  newGeometries[index].humanReadable = e.target.value;\r\n                  setSelectedGeometries(newGeometries)\r\n                }}\r\n              />\r\n            </div>\r\n            {renderDisableMultiSelect(index)}\r\n            <div style={{textAlign: \"left\", marginLeft: 16}}>\r\n              <div style={{color: \"green\", fontWeight: \"bold\"}}>Disable When Selected:</div>\r\n              {renderDisableTextureControls(index)}\r\n            </div>\r\n          </div>\r\n          <div style={{display: \"flex\", flex: \"1 1 auto\"}}>\r\n              <button \r\n                title=\"Remove option\"\r\n                onClick={() => {\r\n                  let newUnselectedGeometries = JSON.parse(JSON.stringify(unselectedGeometries))\r\n                  let newConfiguration = JSON.parse(JSON.stringify(option.configuration))\r\n                  let unSelectedGeometry = newConfiguration.geometries.splice(index, 1)[0]\r\n                  newUnselectedGeometries.unshift(unSelectedGeometry)\r\n                  dispatch(updateControl({ id: option.id, key: \"configuration\", value: newConfiguration }))\r\n                  dispatch(setUnselectedGeometries(newUnselectedGeometries))\r\n                }}\r\n              >\r\n                <svg \r\n                  fill=\"currentColor\" \r\n                  preserveAspectRatio=\"xMidYMid meet\" \r\n                  height=\"1em\" \r\n                  width=\"1em\" \r\n                  viewBox=\"0 0 40 40\" \r\n                  style={{verticalAlign: \"middle\"}}\r\n                >\r\n                  <g>\r\n                    <path d=\"m15.9 30.7v-15.7q0-0.3-0.2-0.5t-0.5-0.2h-1.4q-0.3 0-0.5 0.2t-0.2 0.5v15.7q0 0.3 0.2 \r\n                    0.5t0.5 0.2h1.4q0.3 0 0.5-0.2t0.2-0.5z m5.7 0v-15.7q0-0.3-0.2-0.5t-0.5-0.2h-1.4q-0.3 0-0.5 \r\n                    0.2t-0.2 0.5v15.7q0 0.3 0.2 0.5t0.5 0.2h1.4q0.3 0 0.5-0.2t0.2-0.5z m5.8 \r\n                    0v-15.7q0-0.3-0.2-0.5t-0.6-0.2h-1.4q-0.3 0-0.5 0.2t-0.2 0.5v15.7q0 0.3 0.2 0.5t0.5 \r\n                    0.2h1.4q0.4 0 0.6-0.2t0.2-0.5z m-12.2-22.1h10l-1.1-2.6q-0.1-0.2-0.3-0.3h-7.1q-0.2 \r\n                    0.1-0.4 0.3z m20.7 0.7v1.4q0 0.3-0.2 0.5t-0.5 0.2h-2.1v21.2q0 1.8-1.1 3.2t-2.5 \r\n                    1.3h-18.6q-1.4 0-2.5-1.3t-1-3.1v-21.3h-2.2q-0.3 0-0.5-0.2t-0.2-0.5v-1.4q0-0.3 \r\n                    0.2-0.5t0.5-0.2h6.9l1.6-3.8q0.3-0.8 1.2-1.4t1.7-0.5h7.2q0.9 0 1.8 0.5t1.2 1.4l1.5 \r\n                    3.8h6.9q0.3 0 0.5 0.2t0.2 0.5z\"></path>\r\n                  </g>\r\n                </svg>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )\r\n      })\r\n    }\r\n\r\n    const renderDisableTextureControls = (geometryIndex) => {\r\n      return controls.filter(control => control.type === \"textureCategory\").map(control => {\r\n        let showChecked = option.configuration.geometries[geometryIndex].disabledTextureControls.includes(control.name)\r\n        return (\r\n          <div style={{display: \"flex\"}}>\r\n            <input \r\n              type=\"checkbox\" \r\n              checked={showChecked}\r\n              onChange={() => {        \r\n                let newConfiguration = JSON.parse(JSON.stringify(option.configuration))\r\n                if (showChecked) {                    \r\n                  newConfiguration.geometries[geometryIndex].disabledTextureControls = newConfiguration.geometries[geometryIndex].disabledTextureControls.filter(disabledTextureControls => disabledTextureControls !== control.name)\r\n                } else {                  \r\n                  newConfiguration.geometries[geometryIndex].disabledTextureControls.push(control.name)\r\n                }\r\n                dispatch(updateControl({id: option.id, key: \"configuration\", value: newConfiguration}))\r\n              }}\r\n            />\r\n            <div>{control.name}</div>\r\n          </div>\r\n      )})    \r\n    }\r\n\r\n    const renderDisableMultiSelect = (geometryIndex) => {\r\n    \r\n      var multiSelects = [];\r\n      for (let i=0; i<controls.length; ++i) {\r\n        if (controls[i].type === \"geometryCategory\" && controls[i].id !== option.id) {\r\n          \r\n          var multiSelect = controls[i].configuration.geometries.map((geometry, complimentGeometryIndex) => {\r\n            let showChecked = false;\r\n            \r\n            if (option.configuration.geometries[geometryIndex].hiddenValues === undefined) { //backwards-compatibility\r\n              let newConfiguration = JSON.parse(JSON.stringify(option.configuration))\r\n              newConfiguration.geometries[geometryIndex].hiddenValues = []\r\n              dispatch(updateControl({id: option.id, key: \"configuration\", value: newConfiguration}))\r\n            }\r\n            if (option.configuration.geometries[geometryIndex].hiddenValues.includes(geometry.designation)) {\r\n              showChecked = true;\r\n            }\r\n            \r\n            return (\r\n            <div style={{display: \"flex\"}}>\r\n              <input \r\n                type=\"checkbox\" \r\n                checked={showChecked}\r\n                onChange={() => {        \r\n                  let newConfiguration = JSON.parse(JSON.stringify(option.configuration))\r\n                  console.log(\"controls[i]:\")\r\n                  console.log(controls[i])\r\n                  if(showChecked) {                    \r\n                    newConfiguration.geometries[geometryIndex].hiddenValues = newConfiguration.geometries[geometryIndex].hiddenValues.filter(hiddenElementDesignation => hiddenElementDesignation !== geometry.designation)\r\n                  } else {\r\n                    newConfiguration.geometries[geometryIndex].hiddenValues.push(geometry.designation)\r\n                  }\r\n                  dispatch(updateControl({id: option.id, key: \"configuration\", value: newConfiguration}))\r\n                }}\r\n              />\r\n              <div>{geometry.designation}</div>\r\n            </div>            \r\n            )\r\n          })\r\n          multiSelects.push(\r\n            <div>\r\n              <div style={{marginLeft: 4, color: \"blue\"}}>{controls[i].name}</div>\r\n              {multiSelect}\r\n            </div>\r\n          )\r\n        }\r\n      }\r\n      return (\r\n        <div style={{textAlign: \"left\", marginLeft: 16}}>\r\n          <div style={{color: \"blue\", fontWeight: \"bold\"}}>Disable When Selected:</div>\r\n          {multiSelects}\r\n        </div>\r\n      )\r\n    }\r\n\r\n    const setSelectedGeometries = (selectedGeometries) => {\r\n      let newConfiguration = JSON.parse(JSON.stringify(option.configuration))\r\n      newConfiguration.geometries = selectedGeometries\r\n      dispatch(updateControl({ id: option.id, key: \"configuration\", value: newConfiguration }))\r\n    }\r\n  \r\n    return (\r\n      <div className=\"grouping__container\">\r\n        <div style={{display:\"flex\"}}>\r\n          <p className=\"nameFieldTitle\">Initial :</p>\r\n          <select onChange={(e) => dispatch(updateControl({id: option.id, key: \"initialValue\", value: e.target.value}))}>\r\n            {selectedGeometries.map((geometry, index) => {\r\n              let selected = false;\r\n              if(option.initialValue === \"\" && index === 0) {\r\n                selected = true\r\n                dispatch(updateControl({id: option.id, key: \"initialValue\", value: geometry.designation}))\r\n              } else {\r\n                selected = geometry.designation === option.initialValue\r\n              }\r\n              \r\n              return (<option selected={selected} value={geometry.designation}>{geometry.designation}</option>)\r\n            })}\r\n          </select>\r\n        </div>\r\n        <div className=\"additional-color__container\" id={`${option.id}-additionalColors`}>\r\n          <div style={{display: \"flex\", color: \"blue\", fontWeight: \"bold\"}}>Selected Geometries: {option.configuration.geometries.length}</div>\r\n          <div style={{borderBottom: \"1px solid black\"}}>\r\n            <ReactSortable list={selectedGeometries} setList={selectedGeometries => setSelectedGeometries(selectedGeometries)}>\r\n              {renderSelectedGeometryMultiselect()}     \r\n            </ReactSortable>\r\n          </div>\r\n          <div style={{display: \"flex\", color: \"blue\", fontWeight: \"bold\"}}>Select A Geometry:</div>\r\n          {renderUnselectedGeometryMultiselect()}          \r\n        </div>\r\n      </div>\r\n    )\r\n}\r\n\r\nexport default GeometryCategoryPanel;\r\n","import React from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { \r\n    updateControl,\r\n} from './viewerSlice';\r\nimport { ReactSortable } from 'react-sortablejs';\r\n\r\nconst TextureConfigurationPanel = props => {\r\n    const { option } = props;\r\n    const dispatch = useDispatch();\r\n\r\n    const renderMaterialNameSegmentMap = () => option.configuration.options.map((designation, index) => (\r\n        <div>\r\n            {designation.name}\r\n            <input \r\n                value={designation.humanReadable} \r\n                onChange={(e) => {\r\n                    let newConfiguration = JSON.parse(JSON.stringify(option.configuration))\r\n                    newConfiguration.options[index].humanReadable = e.target.value;\r\n                    dispatch(updateControl({id: option.id, key: \"configuration\", value: newConfiguration}))\r\n                }}\r\n            />\r\n        </div>\r\n    ))\r\n\r\n    const updateOptions = (newOptions) => {\r\n        let newConfiguration = JSON.parse(JSON.stringify(option.configuration))\r\n        newConfiguration.options = newOptions;\r\n        dispatch(updateControl({id: option.id, key: \"configuration\", value: newConfiguration}))\r\n    }\r\n  \r\n    return (\r\n      <div className=\"grouping__container\">\r\n        <div style={{display:\"flex\"}}>\r\n            <p className=\"nameFieldTitle\">Initial :</p>\r\n            <select onChange={(e) => dispatch(updateControl({id: option.id, key: \"initialValue\", value: e.target.value}))}>\r\n                {option.configuration.options.map((designation, index) => {\r\n                    let selected = false;\r\n                    if((option.initialValue === \"\" || option.initialValue === undefined) && index === 0) {\r\n                        selected = true\r\n                        dispatch(updateControl({id: option.id, key: \"initialValue\", value: designation.name}))\r\n                    } else {\r\n                        selected = designation.name === option.initialValue\r\n                    }\r\n                    \r\n                    return   (<option selected={selected} value={designation.name}>{designation.name}</option>)\r\n                })}\r\n            </select>\r\n        </div>\r\n          <div>\r\n            <h4>Code Name Map:</h4>\r\n            <ReactSortable list={option.configuration.options} setList={newOptions => updateOptions(newOptions)}>\r\n                {renderMaterialNameSegmentMap()}\r\n            </ReactSortable>\r\n          </div>\r\n      </div>\r\n    )\r\n}\r\n\r\nexport default TextureConfigurationPanel;\r\n","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { \r\n  selectSceneGraph,\r\n  updateControl,\r\n} from './viewerSlice';\r\n\r\nconst TogglePanel = props => {\r\n\r\n    const dispatch = useDispatch();\r\n    const { option } = props;\r\n    const sceneGraph = useSelector(selectSceneGraph);\r\n\r\n    const sceneGraphHtml = sceneGraph.map(node => <option value={node.instanceID}>{addDashes(node.depth)}{node.name}</option>)\r\n    sceneGraphHtml.unshift(<option value={0}>Select a Node</option>)\r\n  \r\n    return (\r\n      <select \r\n        name=\"nodes\" \r\n        id=\"nodes\"\r\n        className=\"material__select\"\r\n        value={option.entity.instanceID}\r\n        onChange={e => dispatch(updateControl({id: option.id, key: \"entity\", value: {instanceID: e.target.value}}))}\r\n      >\r\n        {sceneGraphHtml}\r\n      </select>\r\n    )\r\n}\r\n  \r\nconst addDashes = number => {\r\n    var dashes = \"\";\r\n    for (let i=0; i<number; ++i) {\r\n        dashes += \"--\"\r\n    }\r\n\r\n    return dashes;\r\n}\r\n\r\nexport default TogglePanel;\r\n","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { \r\n  toggleOptionChoiceModalDisplay, \r\n  selectControls, \r\n  selectDisableButtons,\r\n  updateControl,\r\n  setControls,\r\n} from './viewerSlice';\r\nimport AnimationPanel from './AnimationPanel';\r\nimport ColorPanel from './ColorPanel';\r\nimport GeometryCategoryPanel from './GeometryCategoryPanel'\r\nimport TextureConfigurationPanel from './TextureCategoryPanel';\r\nimport TogglePanel from './TogglePanel';\r\nimport { ReactSortable } from 'react-sortablejs';\r\n\r\nconst panelColors = {\r\n  animation: \"red\",\r\n  color: \"yellow\",\r\n  geometryCategory: \"blue\",\r\n  textureCategory: \"green\",\r\n  toggle: \"purple\",\r\n}\r\n\r\nconst OptionPanel = () => {  \r\n  \r\n  const options = useSelector(selectControls);\r\n  const disableButtons = useSelector(selectDisableButtons) && false;\r\n\r\n  const dispatch = useDispatch();\r\n\r\nconst renderPanel = (option) => {\r\n  if (option.type === \"animation\") {\r\n    return <AnimationPanel option={option} />;\r\n  } else if (option.type === \"color\") {\r\n    return <ColorPanel option={option} />;\r\n  } else if (option.type === \"geometryCategory\") {\r\n    return <GeometryCategoryPanel option={option} />;\r\n  } else if (option.type === \"textureCategory\") {\r\n    return <TextureConfigurationPanel option={option} />;\r\n  } else if (option.type === \"toggle\") {\r\n    return <TogglePanel option={option} />;\r\n  }\r\n}\r\n\r\nconst renderOptions = (options, dispatch) => {\r\n  \r\n  let optionsHtml = options.map((option, index, array) => (\r\n    <div className=\"single-option__panel\" key={`option-${index}`}>\r\n      <div className=\"single-option__header\">\r\n        <h3 className=\"single-option__title\" style={{color: panelColors[option.type]}}>{option.name}</h3>\r\n        <button \r\n          id={`collapseButton${option.id}`}\r\n          className=\"collapse__button\"\r\n          onClick={(e) => dispatch(updateControl({\r\n            id: option.id,\r\n            key: \"isExpanded\",\r\n            value: !option.isExpanded\r\n          }))}\r\n        >\r\n          {option.isExpanded ? \"Collapse\" : \"Expand\"}\r\n        </button>\r\n        <button \r\n          title=\"Remove option\"\r\n          onClick={() => {\r\n            const newArray = array.filter(control => control.id !== option.id);\r\n            dispatch(setControls(newArray));\r\n          }}\r\n        >\r\n          <svg \r\n            fill=\"currentColor\" \r\n            preserveAspectRatio=\"xMidYMid meet\" \r\n            height=\"1em\" \r\n            width=\"1em\" \r\n            viewBox=\"0 0 40 40\" \r\n            style={{verticalAlign: \"middle\"}}\r\n          >\r\n            <g>\r\n              <path d=\"m15.9 30.7v-15.7q0-0.3-0.2-0.5t-0.5-0.2h-1.4q-0.3 0-0.5 0.2t-0.2 0.5v15.7q0 0.3 0.2 \r\n              0.5t0.5 0.2h1.4q0.3 0 0.5-0.2t0.2-0.5z m5.7 0v-15.7q0-0.3-0.2-0.5t-0.5-0.2h-1.4q-0.3 0-0.5 \r\n              0.2t-0.2 0.5v15.7q0 0.3 0.2 0.5t0.5 0.2h1.4q0.3 0 0.5-0.2t0.2-0.5z m5.8 \r\n              0v-15.7q0-0.3-0.2-0.5t-0.6-0.2h-1.4q-0.3 0-0.5 0.2t-0.2 0.5v15.7q0 0.3 0.2 0.5t0.5 \r\n              0.2h1.4q0.4 0 0.6-0.2t0.2-0.5z m-12.2-22.1h10l-1.1-2.6q-0.1-0.2-0.3-0.3h-7.1q-0.2 \r\n              0.1-0.4 0.3z m20.7 0.7v1.4q0 0.3-0.2 0.5t-0.5 0.2h-2.1v21.2q0 1.8-1.1 3.2t-2.5 \r\n              1.3h-18.6q-1.4 0-2.5-1.3t-1-3.1v-21.3h-2.2q-0.3 0-0.5-0.2t-0.2-0.5v-1.4q0-0.3 \r\n              0.2-0.5t0.5-0.2h6.9l1.6-3.8q0.3-0.8 1.2-1.4t1.7-0.5h7.2q0.9 0 1.8 0.5t1.2 1.4l1.5 \r\n              3.8h6.9q0.3 0 0.5 0.2t0.2 0.5z\"></path>\r\n            </g>\r\n          </svg>\r\n        </button>\r\n      </div>\r\n      <div style={{display: option.isExpanded ? \"block\" : \"none\"}}>\r\n        <div style={{display:\"flex\"}}>\r\n          <p className=\"nameFieldTitle\">Name:</p>\r\n          <input \r\n            type=\"text\" \r\n            name=\"colorName\" \r\n            id=\"colorName\" \r\n            value={option.name} \r\n            onChange={(e) => dispatch(updateControl({id: option.id, key: \"name\", value: e.target.value}))}\r\n          />\r\n        </div>\r\n        {renderPanel(option)}\r\n      </div>\r\n    </div>\r\n  ))\r\n\r\n  return optionsHtml;\r\n}\r\n\r\n  return (\r\n    <div style={{overflow: \"auto\", display: \"flex\", flexDirection: \"column\"}}>\r\n      <button \r\n        className=\"add-option add__button\" \r\n        disabled={disableButtons}\r\n        onClick={() => dispatch(toggleOptionChoiceModalDisplay())}\r\n      >+ Add Configurable Element</button>\r\n      <div className=\"single-option__panels__container\">\r\n        <ReactSortable list={options} setList={options => dispatch(setControls(options))}>\r\n          {renderOptions(options, dispatch)}\r\n        </ReactSortable>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default OptionPanel;\r\n","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { \r\n  selectSceneGraph,\r\n  selectSketchfabAPI,\r\n  setSceneGraphIsVisible,\r\n  selectSceneGraphIsVisible,\r\n  setAllNodesVisible,\r\n} from './viewerSlice';\r\n\r\nconst NodePanel = () => {\r\n    const dispatch = useDispatch()\r\n    const sceneGraph = useSelector(selectSceneGraph);\r\n    const sketchfabAPI = useSelector(selectSketchfabAPI);\r\n    const sceneGraphIsVisible = useSelector(selectSceneGraphIsVisible);\r\n\r\n    const sceneGraphHtml = sceneGraph.map(node => {\r\n      return (\r\n        <div style={{display: \"flex\"}}>\r\n          <input \r\n            id={node.instanceID}\r\n            type=\"checkbox\" \r\n            checked={sceneGraphIsVisible[node.instanceID]}\r\n            onChange={(e) => {\r\n                if (e.target.checked) {\r\n                    sketchfabAPI.show(e.target.id)\r\n                    dispatch(setSceneGraphIsVisible({id: e.target.id, value: true}))\r\n                } else {\r\n                    sketchfabAPI.hide(e.target.id)\r\n                    dispatch(setSceneGraphIsVisible({id: e.target.id, value: false}))\r\n                }\r\n            }}\r\n          />\r\n          <div className=\"node-name\">{addDashes(node.depth)}{node.name} - type: {node.type}</div>\r\n        </div>\r\n      )\r\n    })\r\n\r\n    sceneGraphHtml.unshift(\r\n      <div style={{display: \"flex\",borderBottom: \"1px solid black\"}}>\r\n        <input \r\n          type=\"checkbox\" \r\n          checked={Object.values(sceneGraphIsVisible).reduce((accum, curr) => accum && curr)}\r\n          onChange={(e) => {\r\n            dispatch(setAllNodesVisible(e.target.checked))\r\n          }}\r\n        />\r\n        <div className=\"node-name\">All Nodes</div>\r\n      </div>\r\n    )\r\n\r\n  return (\r\n    <div style={{overflow: \"auto\"}}>\r\n        <div id=\"nodeControls\">\r\n            {sceneGraphHtml}\r\n        </div>\r\n        <div id=\"animationControls\"></div>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst addDashes = number => {\r\n    var dashes = \"\";\r\n    for (let i=0; i<number; ++i) {\r\n        dashes += i+1 + \"_\"\r\n    }\r\n\r\n    return dashes;\r\n}\r\n\r\nexport default NodePanel;\r\n","import Sketchfab from '@sketchfab/viewer-api';\r\nimport { buildTextureOptions } from './utils'\r\nimport {\r\n    setSketchfabAPI,\r\n    setAnimations,\r\n    setTextureControls,\r\n    toggleDisableButtons,\r\n    setSceneGraph,\r\n    setMaterials,\r\n    setSurfaceOptionMap,\r\n} from './viewerSlice';\r\n\r\nconst initializeViewer = modelId => dispatch => {\r\n  \r\n    var iframe = document.getElementById('api-frame');\r\n    var version = '1.9.0';\r\n    var DEFAULT_URLID = '256c6851707048a69320bffb9573e448';\r\n    \r\n    var CONFIG = {\r\n        urlid: modelId !== '' ? modelId : DEFAULT_URLID,\r\n    };\r\n    var isSeeking;\r\n    var animationsList = [];\r\n    var current_anim;\r\n    var apiSkfb;\r\n    var pollTime, duration;\r\n    var timeSlider;\r\n  \r\n    pollTime = function() {\r\n          apiSkfb.getCurrentTime(function(err, time) {\r\n                if (!isSeeking) {\r\n                    var percentage = (100 * time) / duration;\r\n                    timeSlider.value = percentage;\r\n                                        \r\n                    var timeDisplay = document.getElementById('timeDisplay');\r\n                    timeDisplay.innerHTML = time.toFixed(2);\r\n                    if (time == 2) {\r\n                      apiSkfb.seekTo(1);\r\n                    }\r\n                requestAnimationFrame(pollTime);\r\n              }\r\n          });\r\n    };\r\n  \r\n    var Configurator = {\r\n        api: null,\r\n        config: null,\r\n        options: [],\r\n  \r\n        init: function (config, iframe) {\r\n            this.config = config;\r\n            var client = new Sketchfab(version, iframe);\r\n            client.init(config.urlid, {\r\n                ui_controls: 0,\r\n                graph_optimizer: 0,\r\n                ui_animations: 0,\r\n                ui_watermark: 0,\r\n                ui_inspector: 0,\r\n                ui_stop: 0,\r\n                ui_infos: 0,\r\n  \r\n                success: function onSuccess(api) {\r\n                    var controls = document.getElementById('animationControls');\r\n                    var buttonsText = `\r\n                        <div style=\"display: flex; justify-content: center;\">\r\n                          <p id=\"timeDisplay\"></p>\r\n                          <p id=\"animationName\" style=\"margin-left: 50px;\"></p>\r\n                        </div>\r\n                        <button id=\"play\">Play</button>\r\n                        <button id=\"pause\">Pause</button>\r\n                        <button id=\"previous\">Previous</button>\r\n                        <button id=\"next\">Next</button>\r\n                        <input \r\n                          id=\"timeSlider\" \r\n                          class=\"slider timeSlider\" \r\n                          style=\"width:100%\" \r\n                          type=\"range\" \r\n                          min=\"0\" \r\n                          max=\"100\" \r\n                          step=\"0.1\" \r\n                          value=\"0\"\r\n                        />\r\n                    `;\r\n                \r\n                    controls.innerHTML = buttonsText;\r\n  \r\n                    apiSkfb = api;\r\n                    dispatch(setSketchfabAPI(api));\r\n                    api.start();\r\n                    api.addEventListener('viewerready', function () {\r\n                        this.api = api;\r\n                        api.pause();\r\n  \r\n                        api.getAnimations(function(err, animations) {\r\n                            animationsList = animations;\r\n  \r\n                            dispatch(setAnimations(animations));\r\n  \r\n                            if (animations.length == 0) {                            \r\n                                var controls = document.getElementById('animationControls');\r\n                                controls.innerHTML = \"\";\r\n                            } else {  \r\n                                document.getElementById('pause').addEventListener('click', function() {\r\n                                    api.pause();\r\n                                });\r\n      \r\n                                document.getElementById('play').addEventListener('click', function() {\r\n                                    api.play();\r\n                                });\r\n      \r\n                                document.getElementById('previous').addEventListener('click', function() {\r\n                                    if (current_anim === 0) current_anim = animationsList.length;\r\n                                    current_anim--;\r\n                    \r\n                                    api.setCurrentAnimationByUID(animationsList[current_anim][0]);\r\n                                    api.seekTo(0);\r\n                                    duration = animationsList[current_anim][2];\r\n                                    var animationName = document.getElementById('animationName');\r\n                                    animationName.innerHTML = animationsList[current_anim][1];\r\n                                });\r\n                    \r\n                                document.getElementById('next').addEventListener('click', function() {\r\n                                    current_anim++;\r\n                                    if (current_anim === animationsList.length) current_anim = 0;\r\n                    \r\n                                    api.setCurrentAnimationByUID(animationsList[current_anim][0]);\r\n                                    api.seekTo(0);\r\n                                    duration = animationsList[current_anim][2];\r\n                                    var animationName = document.getElementById('animationName');\r\n                                    animationName.innerHTML = animationsList[current_anim][1];\r\n                                });\r\n  \r\n                                var animationName = document.getElementById('animationName');\r\n                                animationName.innerHTML = animationsList[0][1];\r\n                                current_anim = 0;\r\n                                api.setCurrentAnimationByUID(animations[current_anim][0]);\r\n                                duration = animations[current_anim][2];\r\n                                isSeeking = false;\r\n                                timeSlider = document.getElementById('timeSlider');\r\n            \r\n                                timeSlider.addEventListener('change', function() {\r\n                                    isSeeking = false;\r\n  \r\n                                    var time = (duration * timeSlider.value) / 100;\r\n                                    var timeDisplay = document.getElementById('timeDisplay');\r\n                                    timeDisplay.innerHTML = time.toFixed(2);\r\n                                });\r\n            \r\n                                timeSlider.addEventListener('input', function() {\r\n                                    isSeeking = true;\r\n                                    var time = (duration * timeSlider.value) / 100;\r\n                                    var timeDisplay = document.getElementById('timeDisplay');\r\n                                    timeDisplay.innerHTML = time.toFixed(2);\r\n                                    api.pause();\r\n                                    api.seekTo(time);\r\n                                });\r\n                                \r\n                                pollTime();\r\n                            }\r\n                        });\r\n  \r\n                        \r\n                        dispatch(toggleDisableButtons());\r\n                        \r\n                        api.getSceneGraph(function(err, result) {\r\n                            if (err) {\r\n                                console.log('Error getting nodes');\r\n                                return;\r\n                            }                  \r\n                            dispatch(setSceneGraph(result))        \r\n                        });\r\n  \r\n                        api.getMaterialList(function(err, materials) {\r\n                            dispatch(setMaterials(materials));\r\n                            \r\n                            let surfaceOptions = buildTextureOptions(materials)\r\n                            \r\n                            dispatch(setSurfaceOptionMap(surfaceOptions.surfaceOptionMap))\r\n                            dispatch(setTextureControls(surfaceOptions.surfaceControls))\r\n                        });\r\n                    }.bind(this));\r\n                }.bind(this),\r\n                error: function onError() {\r\n                    console.log('Viewer error');\r\n                }\r\n            });\r\n        }\r\n    }\r\n  \r\n    Configurator.init(CONFIG, iframe);\r\n  };\r\n\r\nexport default initializeViewer;\r\n","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { \r\n  selectModelList,\r\n  selectActiveModelGUID,\r\n  setModelId, \r\n  setModelName,\r\n  setIsInitialModel,\r\n} from './viewerSlice';\r\nimport initializeViewer from './initializeViewer';\r\n\r\nconst ModelPanel = () => {\r\n    const dispatch = useDispatch();\r\n    const modelList = useSelector(selectModelList);\r\n    const activeModelGUID = useSelector(selectActiveModelGUID)\r\n\r\n    let activeModel = modelList.filter(model => model.guid === activeModelGUID)[0]\r\n    if (activeModel !== undefined) {\r\n\r\n        return (\r\n            <div style={{display: \"flex\", flexDirection: \"column\"}}>\r\n                <div style={{marginLeft: 3, textAlign: \"left\"}}>Model Name:</div>\r\n                <input\r\n                    style={{marginBottom: 20}}\r\n                    value={activeModel.name == \"\" ? \"\" : activeModel.name}\r\n                    onChange={e => dispatch(setModelName(e.target.value))}\r\n                />\r\n                <div style={{marginLeft: 3, textAlign: \"left\"}}>Model UID:</div>\r\n                <textarea\r\n                    placeholder=\"Enter Model UID here\"\r\n                    style={{width:\"100%\"}}\r\n                    value={activeModel.uid}\r\n                    onChange={e => {\r\n                        dispatch(setModelId(e.target.value))\r\n                        dispatch(initializeViewer(e.target.value))\r\n                    }}\r\n                />     \r\n                <div style={{display: \"flex\", marginLeft: 3}}>\r\n                    <div>Initial Model?</div>\r\n                    <input\r\n                        type={\"checkbox\"}\r\n                        checked={activeModel.isInitial}\r\n                        onChange={e => dispatch(setIsInitialModel(!activeModel.isInitial))}\r\n                    />\r\n                </div>\r\n            </div>\r\n        )\r\n    } else {\r\n\r\n        return <div></div>\r\n    }\r\n}\r\n\r\nexport default ModelPanel;\r\n","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { \r\n    setViewMode,\r\n    selectViewMode,\r\n    selectDisableButtons,\r\n} from './viewerSlice';\r\nimport OptionPanel from './OptionPanel';\r\nimport NodePanel from './NodePanel';\r\nimport ModelPanel from './ModelPanel';\r\n\r\nconst ControlMenu = () => {\r\n    const dispatch = useDispatch();\r\n    const viewMode = useSelector(selectViewMode);\r\n    const disableButtons = useSelector(selectDisableButtons);\r\n\r\n    let nodesButtonStyles = {\r\n        backgroundColor: viewMode === \"nodes\" ? \"white\" : \"gray\"\r\n    }\r\n\r\n    let optionsButtonStyles = {\r\n        backgroundColor: viewMode === \"options\" ? \"white\" : \"gray\"\r\n    }\r\n\r\n    let modelButtonStyles = {\r\n        backgroundColor: viewMode === \"model\" ? \"white\" : \"gray\"\r\n    }\r\n\r\n    const renderPanel = (viewMode) => {\r\n        if (viewMode === \"options\") {\r\n            return <OptionPanel />\r\n        } else if (viewMode === \"nodes\") {\r\n            return <NodePanel />\r\n        } else if (viewMode === \"model\") {\r\n            return <ModelPanel />\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"control-menu\">\r\n            <div style={{display: \"flex\"}}>\r\n                <button \r\n                    className=\"control-menu__button\"\r\n                    style={nodesButtonStyles}\r\n                    disabled={disableButtons}\r\n                    onClick={() => dispatch(setViewMode(\"nodes\"))}\r\n                >Nodes</button>\r\n                <button \r\n                    className=\"control-menu__button\"\r\n                    style={optionsButtonStyles}\r\n                    disabled={disableButtons}\r\n                    onClick={() => dispatch(setViewMode(\"options\"))}\r\n                >Options</button>\r\n                <button \r\n                    className=\"control-menu__button\"\r\n                    style={modelButtonStyles}\r\n                    onClick={() => dispatch(setViewMode(\"model\"))}\r\n                >Model</button>\r\n            </div>\r\n            {renderPanel(viewMode)}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ControlMenu;\r\n","import React from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { \r\n    selectModelList,\r\n    selectActiveModelGUID,\r\n    setModelList,\r\n    setActiveModelGUID,\r\n    createModel,\r\n    setViewMode,\r\n} from './viewerSlice';\r\nimport initializeViewer from './initializeViewer';\r\nimport { ReactSortable } from 'react-sortablejs';\r\n\r\nconst modelListStyles = {\r\n    width: \"auto\",\r\n    minWidth: 100,\r\n    paddingLeft: 10,\r\n    paddingRight: 10, \r\n    textAlign: \"center\", \r\n    borderRadius: 25,\r\n    border: \"1px solid\",\r\n}\r\nconst inActiveStyles = { \r\n    backgroundColor: \"teal\", \r\n    color: \"white\", \r\n    borderColor: \"white\",\r\n    cursor: \"pointer\",\r\n    ...modelListStyles,\r\n}\r\nconst activeStyles = { \r\n    backgroundColor: \"white\", \r\n    color: \"teal\", \r\n    borderColor: \"teal\",\r\n    ...modelListStyles,\r\n}\r\n\r\nconst ModelList = () => {\r\n    const modelList = useSelector(selectModelList);\r\n    const activeModelGuid = useSelector(selectActiveModelGUID)\r\n\r\n\r\n    const dispatch = useDispatch();\r\n    return (\r\n        <div style={{display: \"flex\", justifyContent: \"right\"}}>\r\n            <ReactSortable \r\n                style={{display: \"flex\", justifyContent: \"right\"}}\r\n                list={modelList} \r\n                setList={modelList => dispatch(setModelList(modelList))}>\r\n                    {modelList.map(model => (\r\n                        <div \r\n                            style={activeModelGuid === model.guid ? activeStyles : inActiveStyles}\r\n                            id={\"model-\" + model.guid}\r\n                            onClick={e => {\r\n                                let modelGuid = Number(e.target.id.split(\"-\")[1])\r\n                                dispatch(setActiveModelGUID(modelGuid))\r\n                                dispatch(initializeViewer(model.uid))\r\n                            }}\r\n                        >\r\n                            {model.name}\r\n                            <svg \r\n                                fill=\"currentColor\" \r\n                                preserveAspectRatio=\"xMidYMid meet\" \r\n                                height=\"1em\" \r\n                                width=\"1em\" \r\n                                viewBox=\"0 0 40 40\" \r\n                                style={{\r\n                                    marginLeft: \"20px\",\r\n                                    marginRight: \"10px\",\r\n                                    verticalAlign: \"middle\", \r\n                                    cursor: \"pointer\"\r\n                                }}\r\n                                onClick={e => {\r\n                                    let newModelList = modelList.filter(m => m.guid !== model.guid)\r\n                                    dispatch(setViewMode(\"model\"))\r\n                                    dispatch(setModelList(newModelList))\r\n                                }}\r\n                            >\r\n                                <g>\r\n                                    <path d=\"m15.9 30.7v-15.7q0-0.3-0.2-0.5t-0.5-0.2h-1.4q-0.3 0-0.5 0.2t-0.2 0.5v15.7q0 0.3 0.2 \r\n                                    0.5t0.5 0.2h1.4q0.3 0 0.5-0.2t0.2-0.5z m5.7 0v-15.7q0-0.3-0.2-0.5t-0.5-0.2h-1.4q-0.3 0-0.5 \r\n                                    0.2t-0.2 0.5v15.7q0 0.3 0.2 0.5t0.5 0.2h1.4q0.3 0 0.5-0.2t0.2-0.5z m5.8 \r\n                                    0v-15.7q0-0.3-0.2-0.5t-0.6-0.2h-1.4q-0.3 0-0.5 0.2t-0.2 0.5v15.7q0 0.3 0.2 0.5t0.5 \r\n                                    0.2h1.4q0.4 0 0.6-0.2t0.2-0.5z m-12.2-22.1h10l-1.1-2.6q-0.1-0.2-0.3-0.3h-7.1q-0.2 \r\n                                    0.1-0.4 0.3z m20.7 0.7v1.4q0 0.3-0.2 0.5t-0.5 0.2h-2.1v21.2q0 1.8-1.1 3.2t-2.5 \r\n                                    1.3h-18.6q-1.4 0-2.5-1.3t-1-3.1v-21.3h-2.2q-0.3 0-0.5-0.2t-0.2-0.5v-1.4q0-0.3 \r\n                                    0.2-0.5t0.5-0.2h6.9l1.6-3.8q0.3-0.8 1.2-1.4t1.7-0.5h7.2q0.9 0 1.8 0.5t1.2 1.4l1.5 \r\n                                    3.8h6.9q0.3 0 0.5 0.2t0.2 0.5z\"></path>\r\n                                </g>\r\n                            </svg>\r\n                        </div>\r\n                    ))}\r\n            </ReactSortable>\r\n            <div \r\n                style={{\r\n                    ...activeStyles,\r\n                    cursor: \"pointer\",\r\n                    width: 320,\r\n                    padding: 0,\r\n                    \r\n                }}\r\n                onClick={() => {\r\n                    dispatch(createModel())\r\n                }}\r\n            >+ Add Model</div>\r\n        </div>\r\n    )\r\n  }\r\n  \r\n  export default ModelList;\r\n  \r\n  /********\r\n   * \r\n   * HELLO FROM ThE OTHER SIIIIIDE\r\n   * \r\n   *********/","import React from 'react';\r\nimport Header from './components/Header'\r\nimport Viewer from './components/Viewer'\r\nimport ImportModal from './components/ImportModal';\r\nimport ExportModal from './components/ExportModal';\r\nimport OptionChoiceModal from './components/OptionChoiceModal';\r\nimport ControlMenu from './components/ControlMenu';\r\nimport ModelList from './components/ModelList'\r\nimport './App.css';\r\nimport './globals';\r\n\r\nfunction App() {\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Header />\r\n      <ModelList />\r\n      <div className=\"body\">\r\n        <Viewer />\r\n        <ControlMenu />\r\n        <ImportModal />\r\n        <ExportModal />\r\n        <OptionChoiceModal />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { configureStore } from '@reduxjs/toolkit';\r\nimport viewerReducer from '../components/viewerSlice';\r\nimport logger from 'redux-logger';\r\n\r\nexport default configureStore({\r\n  reducer: viewerReducer,\r\n  middleware: (getDefaultMiddleware) => getDefaultMiddleware().concat(logger),\r\n});\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport store from './app/store';\r\nimport { Provider } from 'react-redux';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <App />\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","var buildSceneGraph = function(model, children, depth) {\r\n\tfor (let i=0; i<children.length; ++i) {\r\n    if (children[i].name != \"RootNode\") {\r\n      if(children[i].name == undefined) {\r\n        model.sceneGraph.push({\r\n          name: children[i].type, \r\n          depth: depth, \r\n          instanceID: children[i].instanceID,\r\n          materialID: children[i].materialID,\r\n          type: children[i].type,\r\n        });\r\n      } else {\r\n        model.sceneGraph.push({\r\n          name: children[i].name, \r\n          depth: depth, \r\n          instanceID: children[i].instanceID,\r\n          materialID: children[i].materialID,\r\n          type: children[i].type,\r\n        });\r\n      }\r\n      model.sceneGraphIsVisible[children[i].instanceID] = true\r\n    }\r\n\t\tif (children[i].children != undefined || children[i].children != null) {\t\t\t\r\n\t\t\tbuildSceneGraph(model, children[i].children, depth+1);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nvar buildGeometryCategoryOptions = (model) => {   \r\n\r\n  let uniqueStrings = [];\r\n  let geometryCategoryOptions = [];\r\n  for (let i=0; i<model.sceneGraph.length; ++i) {\r\n    let nodeNameArray = model.sceneGraph[i].name.split(\"-\").filter(string => string != \"\")\r\n    let mainDesignation = nodeNameArray[0];\r\n    let capitalLetter = nodeNameArray[1];\r\n    let detailedTitle = nodeNameArray[2];\r\n    for (let j=3; j<nodeNameArray.length; ++j) {\r\n      detailedTitle += nodeNameArray[j];\r\n    }\r\n\r\n    const irrelevantStrings = [\"Group\", \"RootNode\", \"MatrixTransform\"];\r\n    if (uniqueStrings.indexOf(mainDesignation) == -1 &&\r\n      irrelevantStrings.indexOf(mainDesignation) == -1) {\r\n      uniqueStrings.push(mainDesignation);\r\n\r\n      let isFreeGeometry = true;\r\n      for (let j=0; j<model.controls.length; ++j) {\r\n        if (model.controls[j].type === \"geometryCategory\") {\r\n          for (let k=0; k<model.controls[j].configuration.geometries.length; ++k) {\r\n            if (model.sceneGraph[i].instanceID === model.controls[j].geometries[k].instanceID) {\r\n              isFreeGeometry = false;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (isFreeGeometry === false) {\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (isFreeGeometry) {\r\n        geometryCategoryOptions.push({\r\n          instanceID: model.sceneGraph[i].instanceID,\r\n          designation: mainDesignation,\r\n          capitalLetter: capitalLetter,\r\n          detailedTitle: detailedTitle,\r\n          humanReadable: mainDesignation,\r\n          hiddenValues: [],\r\n          allowsAnimation: true,\r\n        })\r\n\r\n      }\r\n    }\r\n  }\r\n  geometryCategoryOptions.sort(function(a,b){return a.designation.charCodeAt(0)-b.designation.charCodeAt(0)})\r\n  model.geometryCategoryOptions = geometryCategoryOptions;\r\n}\r\n\r\nvar buildTextureOptions = (materials) => {  \r\n    let surfaceOptionMap = {};\r\n    let surfaceControls = [];\r\n    \r\n    for (let i=0; i<materials.length; ++i) {\r\n      var matches = materials[i].name.match(/[a-zA-Z]*-[A-Z]+-[a-zA-Z]+/g);\r\n    \r\n      if (matches !== null) {\r\n        let materialNameArray = materials[i].name.split(\"-\").filter(string => string != \"\")\r\n        let geometryName = materialNameArray[0];\r\n        let materialOptions = materials[i].name.match(/[A-Z]+-/g).map(option => option.replace(\"-\", \"\"));\r\n        let primaryValue = materialOptions[0];\r\n\r\n        // generate select display\r\n        let isNewUniqueGeometry = surfaceOptionMap[geometryName] === undefined;\r\n        if (isNewUniqueGeometry) {\r\n          surfaceOptionMap[geometryName] = {}\r\n\r\n\r\n          surfaceControls.push({\r\n            name: geometryName + \" - Attribute 1\", \r\n            configuration: {\r\n              isPrimary: true,\r\n              ordering: 0,\r\n              geometryName: geometryName, \r\n              options: [{name: materialOptions[0], humanReadable: materialOptions[0]}]\r\n            },\r\n            entity: {instanceID: 0},\r\n            entityIndex: \"none\",\r\n            isExpanded: true,\r\n            type: \"textureCategory\",     \r\n            textureId: surfaceControls.length,       \r\n          })\r\n\r\n          surfaceOptionMap[geometryName][materialOptions[0]] = [];\r\n          for (let j=1; j<materialOptions.length; ++j) {\r\n            surfaceControls.push({\r\n              name: `${geometryName} - Attribute ${j+1}`, \r\n              configuration: {\r\n                isPrimary: false,\r\n                ordering: j,\r\n                geometryName: geometryName, \r\n                options: [{name: materialOptions[j], humanReadable: materialOptions[j]}]\r\n              },\r\n              entity: {instanceID: 0},\r\n              entityIndex: \"none\",\r\n              isExpanded: true,\r\n              type: \"textureCategory\",      \r\n              initialValue: \"\",  \r\n            })\r\n            surfaceOptionMap[geometryName][primaryValue].push([materialOptions[j]])\r\n          }\r\n        } else {\r\n          for (var j=0; j<surfaceControls.length; ++j) {\r\n            if (surfaceControls[j].configuration.geometryName === geometryName) {\r\n\r\n              var optionExists = false;\r\n              for (var k=0; k<surfaceControls[j].configuration.options.length; ++k) {\r\n                if (surfaceControls[j].configuration.options[k].name === materialOptions[0]) {\r\n                  optionExists = true;\r\n                  break;\r\n                }\r\n              }\r\n              if(optionExists === false) {\r\n                surfaceControls[j].configuration.options.push({name: materialOptions[0], humanReadable: materialOptions[0]})\r\n              }\r\n              for (var k=1; k<materialOptions.length; ++k) {\r\n                var optionExists = false;\r\n                for (var l=0; l<surfaceControls[j+k].configuration.options.length; ++l) {\r\n                  if (surfaceControls[j+k].configuration.options[l].name === materialOptions[k]) {\r\n                    optionExists = true;\r\n                    break;\r\n                  }\r\n                }\r\n                if (optionExists === false) {\r\n                  surfaceControls[j+k].configuration.options.push({name: materialOptions[k], humanReadable: materialOptions[k]})\r\n                }\r\n              }\r\n              break;\r\n            }\r\n          }\r\n\r\n          let isNewUniquePrimaryValue = surfaceOptionMap[geometryName][primaryValue] === undefined\r\n          if (isNewUniquePrimaryValue) {\r\n            surfaceOptionMap[geometryName][primaryValue] = [];\r\n            for (let j=1; j<materialOptions.length; ++j) {\r\n              surfaceOptionMap[geometryName][primaryValue].push([materialOptions[j]])\r\n            }\r\n          } else {\r\n            for (let j=1; j<materialOptions.length; ++j) {\r\n              let currentAttributeOptions = surfaceOptionMap[geometryName][primaryValue][j-1];\r\n              let isNewUniqueValue = currentAttributeOptions.indexOf(materialOptions[j]) === -1;\r\n              if (isNewUniqueValue) {\r\n                currentAttributeOptions.push(materialOptions[j])\r\n              }\r\n            }                                  \r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    return {\r\n        surfaceOptionMap,\r\n        surfaceControls,\r\n    }\r\n}\r\n\r\nmodule.exports = {\r\n    buildSceneGraph,\r\n    buildGeometryCategoryOptions,\r\n    buildTextureOptions,\r\n}\r\n"],"sourceRoot":""}